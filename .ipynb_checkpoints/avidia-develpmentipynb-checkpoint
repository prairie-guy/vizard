{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Avidia Vizard Figures Notebook\n",
    "\n",
    "A minimal template for creating visualizations with Vizard.\n",
    "\n",
    "**Quick Reference:**\n",
    "- `%cc KEYWORDS` - Show current state\n",
    "- `%cc RESET` - Clear state, start fresh\n",
    "- `%cc HELP` - Show help\n",
    "\n",
    "**Basic syntax:**\n",
    "```\n",
    "%cc DATA mydata.csv PLOT bar X category Y value\n",
    "%cc Create a scatter plot from mydata.csv with X col1 and Y col2\n",
    "```"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Setup & Basics"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Load necessary imports (one-time setup)\n",
    "Since Vizard defaults to IMPORT false, we load libraries once here."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import os, sys, subprocess, warnings, time, re\n",
    "import altair as alt\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "import polars as pl\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "from pathlib import Path"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Altair"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "alt.renderers.enable('html')\n",
    "#alt.renderers.enable('default') # Critical\n",
    "\n",
    "fontFamily = '' # Seems better to leave empty and go with defaults\n",
    "@alt.theme.register('bioinformatics_theme', enable=True)\n",
    "def bioinformatics_theme():\n",
    "    return alt.theme.ThemeConfig({\n",
    "        'width':  600,\n",
    "        'height': 400, \n",
    "        'config': {\n",
    "            # Separate axis configurations\n",
    "            'axisX': {\n",
    "                'labelFontSize': 14,\n",
    "                'titleFontSize': 18,\n",
    "                'titleFontWeight': 100,\n",
    "                'labelAngle': 0,\n",
    "                'labelFont': fontFamily,\n",
    "                'titleFont': fontFamily,  \n",
    "            },\n",
    "            'axisY': {\n",
    "                'labelFontSize': 14,\n",
    "                'titleFontSize': 18,\n",
    "                'titleFontWeight': 100,\n",
    "                'labelAngle': 0,\n",
    "                'labelFont': fontFamily,\n",
    "                'titleFont': fontFamily,  \n",
    "            },\n",
    "            # Title configuration\n",
    "            'title': {                \n",
    "                'fontSize': 25,       \n",
    "                'fontWeight': 200,    \n",
    "                'offset': 20,\n",
    "                'font': fontFamily,        \n",
    "            },\n",
    "            # Legend configuration\n",
    "            'legend': {\n",
    "                'labelFontSize': 14,\n",
    "                'titleFontSize': 18,\n",
    "                'symbolSize': 600,\n",
    "                'titleFontWeight': 200,\n",
    "                'labelFont': fontFamily,\n",
    "                'titleFont': fontFamily,   \n",
    "            },\n",
    "            # Text mark configuration\n",
    "            'text': {\n",
    "                'font': fontFamily,\n",
    "                'fontWeight': 100,\n",
    "                #'fontSize': 14             # Optional: set default size\n",
    "            }\n",
    "        }})"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Fonts"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "<style>\n",
       "  #altair-viz-31e0577eb7c240e289da3d7e7b046b3b.vega-embed {\n",
       "    width: 100%;\n",
       "    display: flex;\n",
       "  }\n",
       "\n",
       "  #altair-viz-31e0577eb7c240e289da3d7e7b046b3b.vega-embed details,\n",
       "  #altair-viz-31e0577eb7c240e289da3d7e7b046b3b.vega-embed details summary {\n",
       "    position: relative;\n",
       "  }\n",
       "</style>\n",
       "<div id=\"altair-viz-31e0577eb7c240e289da3d7e7b046b3b\"></div>\n",
       "<script type=\"text/javascript\">\n",
       "  var VEGA_DEBUG = (typeof VEGA_DEBUG == \"undefined\") ? {} : VEGA_DEBUG;\n",
       "  (function(spec, embedOpt){\n",
       "    let outputDiv = document.currentScript.previousElementSibling;\n",
       "    if (outputDiv.id !== \"altair-viz-31e0577eb7c240e289da3d7e7b046b3b\") {\n",
       "      outputDiv = document.getElementById(\"altair-viz-31e0577eb7c240e289da3d7e7b046b3b\");\n",
       "    }\n",
       "\n",
       "    const paths = {\n",
       "      \"vega\": \"https://cdn.jsdelivr.net/npm/vega@6?noext\",\n",
       "      \"vega-lib\": \"https://cdn.jsdelivr.net/npm/vega-lib?noext\",\n",
       "      \"vega-lite\": \"https://cdn.jsdelivr.net/npm/vega-lite@6.1.0?noext\",\n",
       "      \"vega-embed\": \"https://cdn.jsdelivr.net/npm/vega-embed@7?noext\",\n",
       "    };\n",
       "\n",
       "    function maybeLoadScript(lib, version) {\n",
       "      var key = `${lib.replace(\"-\", \"\")}_version`;\n",
       "      return (VEGA_DEBUG[key] == version) ?\n",
       "        Promise.resolve(paths[lib]) :\n",
       "        new Promise(function(resolve, reject) {\n",
       "          var s = document.createElement('script');\n",
       "          document.getElementsByTagName(\"head\")[0].appendChild(s);\n",
       "          s.async = true;\n",
       "          s.onload = () => {\n",
       "            VEGA_DEBUG[key] = version;\n",
       "            return resolve(paths[lib]);\n",
       "          };\n",
       "          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);\n",
       "          s.src = paths[lib];\n",
       "        });\n",
       "    }\n",
       "\n",
       "    function showError(err) {\n",
       "      outputDiv.innerHTML = `<div class=\"error\" style=\"color:red;\">${err}</div>`;\n",
       "      throw err;\n",
       "    }\n",
       "\n",
       "    function displayChart(vegaEmbed) {\n",
       "      vegaEmbed(outputDiv, spec, embedOpt)\n",
       "        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));\n",
       "    }\n",
       "\n",
       "    if(typeof define === \"function\" && define.amd) {\n",
       "      requirejs.config({paths});\n",
       "      let deps = [\"vega-embed\"];\n",
       "      require(deps, displayChart, err => showError(`Error loading script: ${err.message}`));\n",
       "    } else {\n",
       "      maybeLoadScript(\"vega\", \"6\")\n",
       "        .then(() => maybeLoadScript(\"vega-lite\", \"6.1.0\"))\n",
       "        .then(() => maybeLoadScript(\"vega-embed\", \"7\"))\n",
       "        .catch(showError)\n",
       "        .then(() => displayChart(vegaEmbed));\n",
       "    }\n",
       "  })({\"width\": 600, \"height\": 400, \"config\": {\"axisX\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"titleFontWeight\": 100, \"labelAngle\": 0, \"labelFont\": \"\", \"titleFont\": \"\"}, \"axisY\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"titleFontWeight\": 100, \"labelAngle\": 0, \"labelFont\": \"\", \"titleFont\": \"\"}, \"title\": {\"fontSize\": 25, \"fontWeight\": 200, \"offset\": 20, \"font\": \"\"}, \"legend\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"symbolSize\": 600, \"titleFontWeight\": 200, \"labelFont\": \"\", \"titleFont\": \"\"}, \"text\": {\"font\": \"\", \"fontWeight\": 100}}, \"vconcat\": [{\"hconcat\": [{\"data\": {\"name\": \"empty\"}, \"mark\": {\"type\": \"text\", \"font\": \"Arial\", \"fontSize\": 14}, \"encoding\": {\"text\": {\"value\": \"Arial\"}, \"x\": {\"value\": 100}, \"y\": {\"value\": 50}}, \"height\": 80, \"title\": \"Arial\", \"width\": 180}, {\"data\": {\"name\": \"empty\"}, \"mark\": {\"type\": \"text\", \"font\": \"Times New Roman\", \"fontSize\": 14}, \"encoding\": {\"text\": {\"value\": \"Times New Roman\"}, \"x\": {\"value\": 100}, \"y\": {\"value\": 50}}, \"height\": 80, \"title\": \"Times New Roman\", \"width\": 180}, {\"data\": {\"name\": \"empty\"}, \"mark\": {\"type\": \"text\", \"font\": \"sans-serif\", \"fontSize\": 14}, \"encoding\": {\"text\": {\"value\": \"sans-serif\"}, \"x\": {\"value\": 100}, \"y\": {\"value\": 50}}, \"height\": 80, \"title\": \"sans-serif\", \"width\": 180}, {\"data\": {\"name\": \"empty\"}, \"mark\": {\"type\": \"text\", \"font\": \"serif\", \"fontSize\": 14}, \"encoding\": {\"text\": {\"value\": \"serif\"}, \"x\": {\"value\": 100}, \"y\": {\"value\": 50}}, \"height\": 80, \"title\": \"serif\", \"width\": 180}]}, {\"hconcat\": [{\"data\": {\"name\": \"empty\"}, \"mark\": {\"type\": \"text\", \"font\": \"monospace\", \"fontSize\": 14}, \"encoding\": {\"text\": {\"value\": \"monospace\"}, \"x\": {\"value\": 100}, \"y\": {\"value\": 50}}, \"height\": 80, \"title\": \"monospace\", \"width\": 180}, {\"data\": {\"name\": \"empty\"}, \"mark\": {\"type\": \"text\", \"font\": \"Helvetica\", \"fontSize\": 14}, \"encoding\": {\"text\": {\"value\": \"Helvetica\"}, \"x\": {\"value\": 100}, \"y\": {\"value\": 50}}, \"height\": 80, \"title\": \"Helvetica\", \"width\": 180}, {\"data\": {\"name\": \"empty\"}, \"mark\": {\"type\": \"text\", \"font\": \"Times\", \"fontSize\": 14}, \"encoding\": {\"text\": {\"value\": \"Times\"}, \"x\": {\"value\": 100}, \"y\": {\"value\": 50}}, \"height\": 80, \"title\": \"Times\", \"width\": 180}, {\"data\": {\"name\": \"empty\"}, \"mark\": {\"type\": \"text\", \"font\": \"Georgia\", \"fontSize\": 14}, \"encoding\": {\"text\": {\"value\": \"Georgia\"}, \"x\": {\"value\": 100}, \"y\": {\"value\": 50}}, \"height\": 80, \"title\": \"Georgia\", \"width\": 180}]}, {\"hconcat\": [{\"data\": {\"name\": \"empty\"}, \"mark\": {\"type\": \"text\", \"font\": \"Calibri\", \"fontSize\": 14}, \"encoding\": {\"text\": {\"value\": \"Calibri\"}, \"x\": {\"value\": 100}, \"y\": {\"value\": 50}}, \"height\": 80, \"title\": \"Calibri\", \"width\": 180}, {\"data\": {\"name\": \"empty\"}, \"mark\": {\"type\": \"text\", \"font\": \"Cambria\", \"fontSize\": 14}, \"encoding\": {\"text\": {\"value\": \"Cambria\"}, \"x\": {\"value\": 100}, \"y\": {\"value\": 50}}, \"height\": 80, \"title\": \"Cambria\", \"width\": 180}]}], \"$schema\": \"https://vega.github.io/schema/vega-lite/v6.1.0.json\", \"datasets\": {\"empty\": [{}]}}, {\"mode\": \"vega-lite\"});\n",
       "</script>"
      ],
      "text/plain": [
       "alt.VConcatChart(...)"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "fonts_to_test = [\n",
    "    # Most reliable cross-platform\n",
    "    'Arial',\n",
    "    'Times New Roman', \n",
    "    \n",
    "    # Generic fallbacks (always work)\n",
    "    'sans-serif',\n",
    "    'serif',\n",
    "    'monospace',\n",
    "    \n",
    "    # Additional reliable options\n",
    "    'Helvetica',        # Mac/Linux, falls back to Arial on Windows\n",
    "    'Times',           # Cross-platform serif\n",
    "    'Georgia',         # Web-safe serif, good readability\n",
    "    \n",
    "    # Office fonts (if available)\n",
    "    'Calibri',         # Modern, clean sans-serif\n",
    "    'Cambria',         # Modern serif designed for screen/print\n",
    "]\n",
    "charts = []\n",
    "for font in fonts_to_test:\n",
    "    chart = alt.Chart().mark_text(fontSize=14, font=font).encode(\n",
    "        x=alt.value(100), y=alt.value(50), text=alt.value(f'{font}')\n",
    "    ).properties(width=180, height=80, title=font[:15])\n",
    "    charts.append(chart)\n",
    "\n",
    "# Display in grid (4 columns)\n",
    "alt.vconcat(*[alt.hconcat(*charts[i:i+4]) for i in range(0, len(charts), 4)])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "vega_colors = {\n",
    "    'blue': '#4c78a8',\n",
    "    'orange': '#f58518',\n",
    "    'red': '#e45756',\n",
    "    'teal': '#72b7b2',\n",
    "    'green': '#54a24b',\n",
    "    'yellow': '#eeca3b',\n",
    "    'purple': '#b279a2',\n",
    "    'pink': '#ff9da6',\n",
    "    'brown': '#9d755d',\n",
    "    'gray': '#bab0ac'\n",
    "}"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Functions"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "def save_chart_alt(chart, title=\"\", fig_path=None, save_as=None, file_format='png', \n",
    "                   hide=False, scale_factor=2.0):\n",
    "    \"\"\"\n",
    "    Save an Altair chart with flexible saving options and optional display.\n",
    "    \n",
    "    Useful for saving charts that have been modified after generation, such as\n",
    "    adding layers, annotations, or combining multiple charts. Provides the same\n",
    "    saving logic and parameter structure as generate_bar_graph_alt.\n",
    "    \n",
    "    Parameters\n",
    "    ----------\n",
    "    chart : altair.Chart\n",
    "        The Altair chart object to save and optionally display.\n",
    "        \n",
    "    title : str, default \"\"\n",
    "        Chart title. Used to generate filename when save_as is not provided.\n",
    "        \n",
    "    fig_path : str or None, default None\n",
    "        Directory path to save the chart. \n",
    "        If None, uses global 'fig_path' value or defaults to 'figures'\n",
    "        \n",
    "    save_as : str or None, default None\n",
    "        File name (excluding extension) to save file.\n",
    "        If None, uses 'title' or generates timestamp-based filename\n",
    "        \n",
    "    file_format : str, default 'png'\n",
    "        File format for saving: 'png', 'pdf', 'svg'\n",
    "        \n",
    "    hide : bool, default False\n",
    "        If True, chart is saved but not displayed.\n",
    "        If False, chart is both saved and displayed.\n",
    "        \n",
    "    scale_factor : float, default 2.0\n",
    "        Scale factor for PNG output (higher values = higher resolution).\n",
    "        Only applies to PNG format.\n",
    "        \n",
    "    Returns\n",
    "    -------\n",
    "    None\n",
    "        Function saves file and optionally displays chart.\n",
    "        \n",
    "    Examples\n",
    "    --------\n",
    "    >>> # Generate base chart\n",
    "    >>> chart, title = generate_bar_graph_alt(df, y_col='Coverage', \n",
    "    ...                                       title='Sample Coverage', \n",
    "    ...                                       return_chart=True)\n",
    "    >>> \n",
    "    >>> # Add vertical line\n",
    "    >>> rule = alt.Chart().mark_rule().encode(x=alt.datum(1.5))\n",
    "    >>> modified_chart = chart + rule\n",
    "    >>> \n",
    "    >>> # Save with same title\n",
    "    >>> save_chart_alt(modified_chart, title)\n",
    "    >>> \n",
    "    >>> # Save with custom filename and hide display\n",
    "    >>> save_chart_alt(modified_chart, title, save_as='coverage_with_line', \n",
    "    ...                 hide=True)\n",
    "    >>> \n",
    "    >>> # Save as PDF in custom directory\n",
    "    >>> save_chart_alt(modified_chart, title, fig_path='analysis/plots',\n",
    "    ...                 file_format='pdf')\n",
    "        \n",
    "    Notes\n",
    "    -----\n",
    "    - Uses same file naming logic as generate_bar_graph_alt\n",
    "    - PNG files are saved with scale_factor for higher resolution\n",
    "    - Other formats (PDF, SVG) ignore scale_factor parameter\n",
    "    - If no title or save_as provided, generates timestamp-based filename\n",
    "    \"\"\"\n",
    "    if fig_path is None: fig_path = globals().get('fig_path', 'figures')\n",
    "    if save_as is None: save_as = title or f\"chart_{datetime.now().strftime('%y%m%d_%H%M%S')}\"\n",
    "    save_as = sanitize(save_as)\n",
    "    #path = fname(fig_path, save_as, file_format)\n",
    "    path = f'{fig_path}/{save_as}.{file_format}'\n",
    "    if file_format == 'png': chart.save(path, scale_factor=scale_factor)\n",
    "    else: chart.save(path)\n",
    "    if not hide: display(chart)\n",
    "\n",
    "def sanitize(title: str) -> str:                                                                                                                                                                               \n",
    "    \"\"\"Sanitize string by replacing specific chars with underscores.\"\"\"                                                                                                                                        \n",
    "    sanitized = re.sub(r'[^a-zA-Z0-9\\s]', '_', title)                                                                                                                                                          \n",
    "    sanitized = re.sub(r'\\s+', '_', sanitized)                                                                                                                                                                 \n",
    "    sanitized = re.sub(r'_+', '_', sanitized)                                                                                                                                                                  \n",
    "    return sanitized.strip('_') "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Vizard"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "üöÄ Claude Code Magic loaded!\n",
      "Features:\n",
      "  ‚Ä¢ Full agentic Claude Code execution\n",
      "  ‚Ä¢ Cell-based code approval workflow\n",
      "  ‚Ä¢ Real-time message streaming\n",
      "  ‚Ä¢ Session state preservation\n",
      "  ‚Ä¢ Conversation continuity across cells\n",
      "\n",
      "Usage:\n",
      "  %cc <instructions>       # Continue with additional instructions (one-line)\n",
      "  %%cc <instructions>      # Continue with additional instructions (multi-line)\n",
      "  %cc_new (or %ccn)        # Start fresh conversation\n",
      "  %cc --help               # Show available options and usage information\n",
      "\n",
      "Context management:\n",
      "  %cc --import <file>       # Add a file to be included in initial conversation messages\n",
      "  %cc --add-dir <dir>       # Add a directory to Claude's accessible directories\n",
      "  %cc --mcp-config <file>   # Set path to a .mcp.json file containing MCP server configurations\n",
      "  %cc --cells-to-load <num> # The number of cells to load into a new conversation (default: all for first %cc, none for %cc_new)\n",
      "\n",
      "Output:\n",
      "  %cc --model <name>       # Model to use for Claude Code (default: sonnet)\n",
      "  %cc --max-cells <num>    # Set the maximum number of cells CC can create per turn (default: 3)\n",
      "\n",
      "Display:\n",
      "  %cc --clean              # Replace prompt cells with Claude's code cells (tell us if you like this feature, maybe it should be the default)\n",
      "  %cc --no-clean           # Turn off the above setting (default)\n",
      "\n",
      "When to use each form:\n",
      "  ‚Ä¢ Use %cc (single %) for:\n",
      "    - Short, one-line instructions\n",
      "\n",
      "  ‚Ä¢ Use %%cc (double %) for:\n",
      "    - Multi-line instructions or detailed prompts\n",
      "\n",
      "Notes:\n",
      "- Restart the kernel to stop the Claude session\n",
      "- Documentation: go/claude-code-jupyter\n",
      "\n"
     ]
    }
   ],
   "source": [
    "%load_ext cc_jupyter "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "‚úÖ Set model to sonnet. Will be used in next new conversation.\n"
     ]
    }
   ],
   "source": [
    "%cc --model sonnet"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Figures"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "‚úÖ Added /home/cdaniels/junk/dsllm/aux to accessible directories. Will be used in next new conversation.\n"
     ]
    }
   ],
   "source": [
    "%cc_new --add-dir aux"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "üß† Claude model: claude-sonnet-4-5-20250929\n",
      "üí≠ Claude: I'll reset the Vizard state to defaults.\n",
      "‚è∫ Bash(\"rm -f .vizard_state.json && cat > .vizard_state.json << 'EOF'\n",
      "{\n",
      "  \"ENGINE\": \"altair\",\n",
      "  \"DF\": \"polars\",\n",
      "  \"WIDTH\": 600,\n",
      "  \"HEIGHT\": 400,\n",
      "  \"FUNCTION\": false,\n",
      "  \"IMPORT\": false,\n",
      "  \"OUTPUT\": \"display\"\n",
      "}\n",
      "EOF\n",
      "\")\n",
      "üí≠ Claude: ‚úì State reset to defaults\n",
      "üìç Claude Code Session ID: 94236e9b-f6c2-469a-b780-90eecb5fee74\n"
     ]
    }
   ],
   "source": [
    "%cc RESET"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [],
   "source": [
    "samples=['CU1', 'CU2', 'CU3', 'CA1', 'CA2', 'CA3', 'GU1', 'GU2', 'GU3', 'GA1', 'GA2', 'GA3']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "df = pl.read_csv('aux/capture.gatk.metrics',separator='\\t')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "============================================================\n",
      "ü§ñ Claude wants to execute code\n",
      "------------------------------------------------------------\n",
      "üìã To approve: Run the cell below\n",
      "‚û°Ô∏è To continue Claude agentically afterward: Run %cc\n",
      "============================================================\n",
      "\n",
      "‚è∫ CreateNotebookCell\n"
     ]
    },
    {
     "data": {
      "text/markdown": [
       "üí≠ Claude: I've created the transformation using Polars' streaming/chaining style:\n",
       "\n",
       "1. **Selected columns**: `SampleID` and `MEDIAN_TARGET_COVERAGE`\n",
       "2. **Added `Dna_type`**: 'cfDNA' if SampleID starts with 'C', otherwise 'gDNA'\n",
       "3. **Added `Treatment`**: 'UMBS' if SampleID contains 'U', otherwise 'SBS'\n",
       "4. **Renamed**: `MEDIAN_TARGET_COVERAGE` ‚Üí `Coverage`\n",
       "\n",
       "The result is stored in `df2` and displayed at the end."
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "%%cc Create df2 from df. Select only columns SampleID and MEDIAN_TARGET_COVERAGE\n",
    "Create a new column Dna_type. If SampleID starts with C it is cfDNA if G it is gDNA\n",
    "Another new column Treatment. If SampleID contins U it is UMBS other wise SBS\n",
    "Rename MEDIAN_TARGET_COVERAGE as Coverage"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (12, 4)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>SampleID</th><th>Coverage</th><th>Dna_type</th><th>Treatment</th></tr><tr><td>str</td><td>f64</td><td>str</td><td>str</td></tr></thead><tbody><tr><td>&quot;CU1&quot;</td><td>125.0</td><td>&quot;cfDNA&quot;</td><td>&quot;UMBS&quot;</td></tr><tr><td>&quot;CU2&quot;</td><td>138.0</td><td>&quot;cfDNA&quot;</td><td>&quot;UMBS&quot;</td></tr><tr><td>&quot;CU3&quot;</td><td>118.0</td><td>&quot;cfDNA&quot;</td><td>&quot;UMBS&quot;</td></tr><tr><td>&quot;CA1&quot;</td><td>94.0</td><td>&quot;cfDNA&quot;</td><td>&quot;SBS&quot;</td></tr><tr><td>&quot;CA2&quot;</td><td>111.0</td><td>&quot;cfDNA&quot;</td><td>&quot;SBS&quot;</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>&quot;GU2&quot;</td><td>70.0</td><td>&quot;gDNA&quot;</td><td>&quot;UMBS&quot;</td></tr><tr><td>&quot;GU3&quot;</td><td>94.0</td><td>&quot;gDNA&quot;</td><td>&quot;UMBS&quot;</td></tr><tr><td>&quot;GA1&quot;</td><td>62.0</td><td>&quot;gDNA&quot;</td><td>&quot;SBS&quot;</td></tr><tr><td>&quot;GA2&quot;</td><td>84.0</td><td>&quot;gDNA&quot;</td><td>&quot;SBS&quot;</td></tr><tr><td>&quot;GA3&quot;</td><td>99.0</td><td>&quot;gDNA&quot;</td><td>&quot;SBS&quot;</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (12, 4)\n",
       "‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê\n",
       "‚îÇ SampleID ‚îÜ Coverage ‚îÜ Dna_type ‚îÜ Treatment ‚îÇ\n",
       "‚îÇ ---      ‚îÜ ---      ‚îÜ ---      ‚îÜ ---       ‚îÇ\n",
       "‚îÇ str      ‚îÜ f64      ‚îÜ str      ‚îÜ str       ‚îÇ\n",
       "‚ïû‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï™‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï™‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï™‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï°\n",
       "‚îÇ CU1      ‚îÜ 125.0    ‚îÜ cfDNA    ‚îÜ UMBS      ‚îÇ\n",
       "‚îÇ CU2      ‚îÜ 138.0    ‚îÜ cfDNA    ‚îÜ UMBS      ‚îÇ\n",
       "‚îÇ CU3      ‚îÜ 118.0    ‚îÜ cfDNA    ‚îÜ UMBS      ‚îÇ\n",
       "‚îÇ CA1      ‚îÜ 94.0     ‚îÜ cfDNA    ‚îÜ SBS       ‚îÇ\n",
       "‚îÇ CA2      ‚îÜ 111.0    ‚îÜ cfDNA    ‚îÜ SBS       ‚îÇ\n",
       "‚îÇ ‚Ä¶        ‚îÜ ‚Ä¶        ‚îÜ ‚Ä¶        ‚îÜ ‚Ä¶         ‚îÇ\n",
       "‚îÇ GU2      ‚îÜ 70.0     ‚îÜ gDNA     ‚îÜ UMBS      ‚îÇ\n",
       "‚îÇ GU3      ‚îÜ 94.0     ‚îÜ gDNA     ‚îÜ UMBS      ‚îÇ\n",
       "‚îÇ GA1      ‚îÜ 62.0     ‚îÜ gDNA     ‚îÜ SBS       ‚îÇ\n",
       "‚îÇ GA2      ‚îÜ 84.0     ‚îÜ gDNA     ‚îÜ SBS       ‚îÇ\n",
       "‚îÇ GA3      ‚îÜ 99.0     ‚îÜ gDNA     ‚îÜ SBS       ‚îÇ\n",
       "‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df2 = (df\n",
    "    .select(['SampleID', 'MEDIAN_TARGET_COVERAGE'])\n",
    "    .with_columns([\n",
    "        pl.when(pl.col('SampleID').str.starts_with('C'))\n",
    "          .then(pl.lit('cfDNA'))\n",
    "          .otherwise(pl.lit('gDNA'))\n",
    "          .alias('Dna_type'),\n",
    "        pl.when(pl.col('SampleID').str.contains('U'))\n",
    "          .then(pl.lit('UMBS'))\n",
    "          .otherwise(pl.lit('SBS'))\n",
    "          .alias('Treatment')\n",
    "    ])\n",
    "    .rename({'MEDIAN_TARGET_COVERAGE': 'Coverage'})\n",
    ")\n",
    "\n",
    "df2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "‚úÖ Continuing Claude session with execution results...\n",
      "\n",
      "============================================================\n",
      "ü§ñ Claude wants to execute code\n",
      "------------------------------------------------------------\n",
      "üìã To approve: Run the cell below\n",
      "‚û°Ô∏è To continue Claude agentically afterward: Run %cc\n",
      "============================================================\n",
      "\n",
      "üí≠ Claude: I'll create a bar chart from df2 showing SampleID vs Coverage colored by Treatment.\n",
      "‚è∫ Bash(\"cat .vizard_state.json\")\n",
      "‚è∫ Bash(\"cat > .vizard_state.json << 'EOF'\n",
      "{\n",
      "  \"ENGINE\": \"altair\",\n",
      "  \"DF\": \"polars\",\n",
      "  \"WIDTH\": 600,\n",
      "  \"HEIGHT\": 400,\n",
      "  \"FUNCTION\": false,\n",
      "  \"IMPORT\": false,\n",
      "  \"OUTPUT\": \"display\",\n",
      "  \"DATA\": \"df2\",\n",
      "  \"PLOT\": \"bar\",\n",
      "  \"X\": \"SampleID\",\n",
      "  \"Y\": \"Coverage\",\n",
      "  \"COLOR\": \"Treatment\"\n",
      "}\n",
      "EOF\n",
      "\")\n",
      "‚è∫ CreateNotebookCell\n"
     ]
    }
   ],
   "source": [
    "%cc DATA df2 PLOT bar X SampleID Y Coverage COLOR Treatment"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "<style>\n",
       "  #altair-viz-4d9ae3b871f34be8b6ea448f7fdd052f.vega-embed {\n",
       "    width: 100%;\n",
       "    display: flex;\n",
       "  }\n",
       "\n",
       "  #altair-viz-4d9ae3b871f34be8b6ea448f7fdd052f.vega-embed details,\n",
       "  #altair-viz-4d9ae3b871f34be8b6ea448f7fdd052f.vega-embed details summary {\n",
       "    position: relative;\n",
       "  }\n",
       "</style>\n",
       "<div id=\"altair-viz-4d9ae3b871f34be8b6ea448f7fdd052f\"></div>\n",
       "<script type=\"text/javascript\">\n",
       "  var VEGA_DEBUG = (typeof VEGA_DEBUG == \"undefined\") ? {} : VEGA_DEBUG;\n",
       "  (function(spec, embedOpt){\n",
       "    let outputDiv = document.currentScript.previousElementSibling;\n",
       "    if (outputDiv.id !== \"altair-viz-4d9ae3b871f34be8b6ea448f7fdd052f\") {\n",
       "      outputDiv = document.getElementById(\"altair-viz-4d9ae3b871f34be8b6ea448f7fdd052f\");\n",
       "    }\n",
       "\n",
       "    const paths = {\n",
       "      \"vega\": \"https://cdn.jsdelivr.net/npm/vega@6?noext\",\n",
       "      \"vega-lib\": \"https://cdn.jsdelivr.net/npm/vega-lib?noext\",\n",
       "      \"vega-lite\": \"https://cdn.jsdelivr.net/npm/vega-lite@6.1.0?noext\",\n",
       "      \"vega-embed\": \"https://cdn.jsdelivr.net/npm/vega-embed@7?noext\",\n",
       "    };\n",
       "\n",
       "    function maybeLoadScript(lib, version) {\n",
       "      var key = `${lib.replace(\"-\", \"\")}_version`;\n",
       "      return (VEGA_DEBUG[key] == version) ?\n",
       "        Promise.resolve(paths[lib]) :\n",
       "        new Promise(function(resolve, reject) {\n",
       "          var s = document.createElement('script');\n",
       "          document.getElementsByTagName(\"head\")[0].appendChild(s);\n",
       "          s.async = true;\n",
       "          s.onload = () => {\n",
       "            VEGA_DEBUG[key] = version;\n",
       "            return resolve(paths[lib]);\n",
       "          };\n",
       "          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);\n",
       "          s.src = paths[lib];\n",
       "        });\n",
       "    }\n",
       "\n",
       "    function showError(err) {\n",
       "      outputDiv.innerHTML = `<div class=\"error\" style=\"color:red;\">${err}</div>`;\n",
       "      throw err;\n",
       "    }\n",
       "\n",
       "    function displayChart(vegaEmbed) {\n",
       "      vegaEmbed(outputDiv, spec, embedOpt)\n",
       "        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));\n",
       "    }\n",
       "\n",
       "    if(typeof define === \"function\" && define.amd) {\n",
       "      requirejs.config({paths});\n",
       "      let deps = [\"vega-embed\"];\n",
       "      require(deps, displayChart, err => showError(`Error loading script: ${err.message}`));\n",
       "    } else {\n",
       "      maybeLoadScript(\"vega\", \"6\")\n",
       "        .then(() => maybeLoadScript(\"vega-lite\", \"6.1.0\"))\n",
       "        .then(() => maybeLoadScript(\"vega-embed\", \"7\"))\n",
       "        .catch(showError)\n",
       "        .then(() => displayChart(vegaEmbed));\n",
       "    }\n",
       "  })({\"width\": 600, \"height\": 400, \"config\": {\"axisX\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"titleFontWeight\": 100, \"labelAngle\": 0, \"labelFont\": \"\", \"titleFont\": \"\"}, \"axisY\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"titleFontWeight\": 100, \"labelAngle\": 0, \"labelFont\": \"\", \"titleFont\": \"\"}, \"title\": {\"fontSize\": 25, \"fontWeight\": 200, \"offset\": 20, \"font\": \"\"}, \"legend\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"symbolSize\": 600, \"titleFontWeight\": 200, \"labelFont\": \"\", \"titleFont\": \"\"}, \"text\": {\"font\": \"\", \"fontWeight\": 100}}, \"data\": {\"name\": \"data-0f9cc625635906e94e7f89df1814e60e\"}, \"mark\": {\"type\": \"bar\"}, \"encoding\": {\"color\": {\"field\": \"Treatment\", \"title\": \"Treatment\", \"type\": \"nominal\"}, \"x\": {\"field\": \"SampleID\", \"title\": \"Sample ID\", \"type\": \"nominal\"}, \"y\": {\"field\": \"Coverage\", \"title\": \"Coverage\", \"type\": \"quantitative\"}}, \"$schema\": \"https://vega.github.io/schema/vega-lite/v6.1.0.json\", \"datasets\": {\"data-0f9cc625635906e94e7f89df1814e60e\": [{\"SampleID\": \"CU1\", \"Coverage\": 125.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\"}, {\"SampleID\": \"CU2\", \"Coverage\": 138.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\"}, {\"SampleID\": \"CU3\", \"Coverage\": 118.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\"}, {\"SampleID\": \"CA1\", \"Coverage\": 94.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\"}, {\"SampleID\": \"CA2\", \"Coverage\": 111.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\"}, {\"SampleID\": \"CA3\", \"Coverage\": 31.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\"}, {\"SampleID\": \"GU1\", \"Coverage\": 98.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\"}, {\"SampleID\": \"GU2\", \"Coverage\": 70.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\"}, {\"SampleID\": \"GU3\", \"Coverage\": 94.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\"}, {\"SampleID\": \"GA1\", \"Coverage\": 62.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\"}, {\"SampleID\": \"GA2\", \"Coverage\": 84.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\"}, {\"SampleID\": \"GA3\", \"Coverage\": 99.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\"}]}}, {\"mode\": \"vega-lite\"});\n",
       "</script>"
      ],
      "text/plain": [
       "alt.Chart(...)"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "chart = alt.Chart(df2).mark_bar().encode(\n",
    "    x=alt.X('SampleID:N', title='Sample ID'),\n",
    "    y=alt.Y('Coverage:Q', title='Coverage'),\n",
    "    color=alt.Color('Treatment:N', title='Treatment')\n",
    ").properties(width=600, height=400)\n",
    "\n",
    "chart"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "‚úÖ Continuing Claude session with execution results...\n",
      "\n",
      "============================================================\n",
      "ü§ñ Claude wants to execute code\n",
      "------------------------------------------------------------\n",
      "üìã To approve: Run the cell below\n",
      "‚û°Ô∏è To continue Claude agentically afterward: Run %cc\n",
      "============================================================\n",
      "\n",
      "üí≠ Claude: I'll modify the chart to explicitly order the bars so that samples appear in the sequence you want (CU before CA before GU before GA).\n",
      "‚è∫ CreateNotebookCell\n"
     ]
    }
   ],
   "source": [
    "%cc Change the order of bars so that for each set, CU comes before GA"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "<style>\n",
       "  #altair-viz-8f2543504f094109968fb0d3bc6f8bca.vega-embed {\n",
       "    width: 100%;\n",
       "    display: flex;\n",
       "  }\n",
       "\n",
       "  #altair-viz-8f2543504f094109968fb0d3bc6f8bca.vega-embed details,\n",
       "  #altair-viz-8f2543504f094109968fb0d3bc6f8bca.vega-embed details summary {\n",
       "    position: relative;\n",
       "  }\n",
       "</style>\n",
       "<div id=\"altair-viz-8f2543504f094109968fb0d3bc6f8bca\"></div>\n",
       "<script type=\"text/javascript\">\n",
       "  var VEGA_DEBUG = (typeof VEGA_DEBUG == \"undefined\") ? {} : VEGA_DEBUG;\n",
       "  (function(spec, embedOpt){\n",
       "    let outputDiv = document.currentScript.previousElementSibling;\n",
       "    if (outputDiv.id !== \"altair-viz-8f2543504f094109968fb0d3bc6f8bca\") {\n",
       "      outputDiv = document.getElementById(\"altair-viz-8f2543504f094109968fb0d3bc6f8bca\");\n",
       "    }\n",
       "\n",
       "    const paths = {\n",
       "      \"vega\": \"https://cdn.jsdelivr.net/npm/vega@6?noext\",\n",
       "      \"vega-lib\": \"https://cdn.jsdelivr.net/npm/vega-lib?noext\",\n",
       "      \"vega-lite\": \"https://cdn.jsdelivr.net/npm/vega-lite@6.1.0?noext\",\n",
       "      \"vega-embed\": \"https://cdn.jsdelivr.net/npm/vega-embed@7?noext\",\n",
       "    };\n",
       "\n",
       "    function maybeLoadScript(lib, version) {\n",
       "      var key = `${lib.replace(\"-\", \"\")}_version`;\n",
       "      return (VEGA_DEBUG[key] == version) ?\n",
       "        Promise.resolve(paths[lib]) :\n",
       "        new Promise(function(resolve, reject) {\n",
       "          var s = document.createElement('script');\n",
       "          document.getElementsByTagName(\"head\")[0].appendChild(s);\n",
       "          s.async = true;\n",
       "          s.onload = () => {\n",
       "            VEGA_DEBUG[key] = version;\n",
       "            return resolve(paths[lib]);\n",
       "          };\n",
       "          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);\n",
       "          s.src = paths[lib];\n",
       "        });\n",
       "    }\n",
       "\n",
       "    function showError(err) {\n",
       "      outputDiv.innerHTML = `<div class=\"error\" style=\"color:red;\">${err}</div>`;\n",
       "      throw err;\n",
       "    }\n",
       "\n",
       "    function displayChart(vegaEmbed) {\n",
       "      vegaEmbed(outputDiv, spec, embedOpt)\n",
       "        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));\n",
       "    }\n",
       "\n",
       "    if(typeof define === \"function\" && define.amd) {\n",
       "      requirejs.config({paths});\n",
       "      let deps = [\"vega-embed\"];\n",
       "      require(deps, displayChart, err => showError(`Error loading script: ${err.message}`));\n",
       "    } else {\n",
       "      maybeLoadScript(\"vega\", \"6\")\n",
       "        .then(() => maybeLoadScript(\"vega-lite\", \"6.1.0\"))\n",
       "        .then(() => maybeLoadScript(\"vega-embed\", \"7\"))\n",
       "        .catch(showError)\n",
       "        .then(() => displayChart(vegaEmbed));\n",
       "    }\n",
       "  })({\"width\": 600, \"height\": 400, \"config\": {\"axisX\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"titleFontWeight\": 100, \"labelAngle\": 0, \"labelFont\": \"\", \"titleFont\": \"\"}, \"axisY\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"titleFontWeight\": 100, \"labelAngle\": 0, \"labelFont\": \"\", \"titleFont\": \"\"}, \"title\": {\"fontSize\": 25, \"fontWeight\": 200, \"offset\": 20, \"font\": \"\"}, \"legend\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"symbolSize\": 600, \"titleFontWeight\": 200, \"labelFont\": \"\", \"titleFont\": \"\"}, \"text\": {\"font\": \"\", \"fontWeight\": 100}}, \"data\": {\"name\": \"data-0f9cc625635906e94e7f89df1814e60e\"}, \"mark\": {\"type\": \"bar\"}, \"encoding\": {\"color\": {\"field\": \"Treatment\", \"title\": \"Treatment\", \"type\": \"nominal\"}, \"x\": {\"field\": \"SampleID\", \"sort\": [\"CU1\", \"CU2\", \"CU3\", \"CA1\", \"CA2\", \"CA3\", \"GU1\", \"GU2\", \"GU3\", \"GA1\", \"GA2\", \"GA3\"], \"title\": \"Sample ID\", \"type\": \"nominal\"}, \"y\": {\"field\": \"Coverage\", \"title\": \"Coverage\", \"type\": \"quantitative\"}}, \"$schema\": \"https://vega.github.io/schema/vega-lite/v6.1.0.json\", \"datasets\": {\"data-0f9cc625635906e94e7f89df1814e60e\": [{\"SampleID\": \"CU1\", \"Coverage\": 125.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\"}, {\"SampleID\": \"CU2\", \"Coverage\": 138.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\"}, {\"SampleID\": \"CU3\", \"Coverage\": 118.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\"}, {\"SampleID\": \"CA1\", \"Coverage\": 94.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\"}, {\"SampleID\": \"CA2\", \"Coverage\": 111.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\"}, {\"SampleID\": \"CA3\", \"Coverage\": 31.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\"}, {\"SampleID\": \"GU1\", \"Coverage\": 98.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\"}, {\"SampleID\": \"GU2\", \"Coverage\": 70.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\"}, {\"SampleID\": \"GU3\", \"Coverage\": 94.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\"}, {\"SampleID\": \"GA1\", \"Coverage\": 62.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\"}, {\"SampleID\": \"GA2\", \"Coverage\": 84.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\"}, {\"SampleID\": \"GA3\", \"Coverage\": 99.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\"}]}}, {\"mode\": \"vega-lite\"});\n",
       "</script>"
      ],
      "text/plain": [
       "alt.Chart(...)"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "chart = alt.Chart(df2).mark_bar().encode(\n",
    "    x=alt.X('SampleID:N', \n",
    "            title='Sample ID',\n",
    "            sort=['CU1', 'CU2', 'CU3', 'CA1', 'CA2', 'CA3', 'GU1', 'GU2', 'GU3', 'GA1', 'GA2', 'GA3']),\n",
    "    y=alt.Y('Coverage:Q', title='Coverage'),\n",
    "    color=alt.Color('Treatment:N', title='Treatment')\n",
    ").properties(width=600, height=400)\n",
    "\n",
    "chart"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "<style>\n",
       "  #altair-viz-f610dcb10aca4c1e9a9ec3aef1e2477e.vega-embed {\n",
       "    width: 100%;\n",
       "    display: flex;\n",
       "  }\n",
       "\n",
       "  #altair-viz-f610dcb10aca4c1e9a9ec3aef1e2477e.vega-embed details,\n",
       "  #altair-viz-f610dcb10aca4c1e9a9ec3aef1e2477e.vega-embed details summary {\n",
       "    position: relative;\n",
       "  }\n",
       "</style>\n",
       "<div id=\"altair-viz-f610dcb10aca4c1e9a9ec3aef1e2477e\"></div>\n",
       "<script type=\"text/javascript\">\n",
       "  var VEGA_DEBUG = (typeof VEGA_DEBUG == \"undefined\") ? {} : VEGA_DEBUG;\n",
       "  (function(spec, embedOpt){\n",
       "    let outputDiv = document.currentScript.previousElementSibling;\n",
       "    if (outputDiv.id !== \"altair-viz-f610dcb10aca4c1e9a9ec3aef1e2477e\") {\n",
       "      outputDiv = document.getElementById(\"altair-viz-f610dcb10aca4c1e9a9ec3aef1e2477e\");\n",
       "    }\n",
       "\n",
       "    const paths = {\n",
       "      \"vega\": \"https://cdn.jsdelivr.net/npm/vega@6?noext\",\n",
       "      \"vega-lib\": \"https://cdn.jsdelivr.net/npm/vega-lib?noext\",\n",
       "      \"vega-lite\": \"https://cdn.jsdelivr.net/npm/vega-lite@6.1.0?noext\",\n",
       "      \"vega-embed\": \"https://cdn.jsdelivr.net/npm/vega-embed@7?noext\",\n",
       "    };\n",
       "\n",
       "    function maybeLoadScript(lib, version) {\n",
       "      var key = `${lib.replace(\"-\", \"\")}_version`;\n",
       "      return (VEGA_DEBUG[key] == version) ?\n",
       "        Promise.resolve(paths[lib]) :\n",
       "        new Promise(function(resolve, reject) {\n",
       "          var s = document.createElement('script');\n",
       "          document.getElementsByTagName(\"head\")[0].appendChild(s);\n",
       "          s.async = true;\n",
       "          s.onload = () => {\n",
       "            VEGA_DEBUG[key] = version;\n",
       "            return resolve(paths[lib]);\n",
       "          };\n",
       "          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);\n",
       "          s.src = paths[lib];\n",
       "        });\n",
       "    }\n",
       "\n",
       "    function showError(err) {\n",
       "      outputDiv.innerHTML = `<div class=\"error\" style=\"color:red;\">${err}</div>`;\n",
       "      throw err;\n",
       "    }\n",
       "\n",
       "    function displayChart(vegaEmbed) {\n",
       "      vegaEmbed(outputDiv, spec, embedOpt)\n",
       "        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));\n",
       "    }\n",
       "\n",
       "    if(typeof define === \"function\" && define.amd) {\n",
       "      requirejs.config({paths});\n",
       "      let deps = [\"vega-embed\"];\n",
       "      require(deps, displayChart, err => showError(`Error loading script: ${err.message}`));\n",
       "    } else {\n",
       "      maybeLoadScript(\"vega\", \"6\")\n",
       "        .then(() => maybeLoadScript(\"vega-lite\", \"6.1.0\"))\n",
       "        .then(() => maybeLoadScript(\"vega-embed\", \"7\"))\n",
       "        .catch(showError)\n",
       "        .then(() => displayChart(vegaEmbed));\n",
       "    }\n",
       "  })({\"width\": 600, \"height\": 400, \"config\": {\"axisX\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"titleFontWeight\": 100, \"labelAngle\": 0, \"labelFont\": \"\", \"titleFont\": \"\"}, \"axisY\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"titleFontWeight\": 100, \"labelAngle\": 0, \"labelFont\": \"\", \"titleFont\": \"\"}, \"title\": {\"fontSize\": 25, \"fontWeight\": 200, \"offset\": 20, \"font\": \"\"}, \"legend\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"symbolSize\": 600, \"titleFontWeight\": 200, \"labelFont\": \"\", \"titleFont\": \"\"}, \"text\": {\"font\": \"\", \"fontWeight\": 100}, \"view\": {\"stroke\": \"gray\", \"strokeWidth\": 2}}, \"layer\": [{\"data\": {\"name\": \"data-799be74ece45aad5bdfca780af67b29c\"}, \"mark\": {\"type\": \"bar\", \"width\": 12}, \"encoding\": {\"color\": {\"field\": \"Treatment\", \"title\": \"Treatment\", \"type\": \"nominal\"}, \"x\": {\"axis\": {\"domain\": false, \"grid\": false, \"labels\": false, \"ticks\": false}, \"field\": \"x_position\", \"scale\": {\"domain\": [-1.5, 17.5]}, \"title\": null, \"type\": \"quantitative\"}, \"y\": {\"axis\": {\"grid\": false}, \"field\": \"Coverage\", \"scale\": {\"domain\": [0, 170]}, \"title\": \"Coverage\", \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-aa5469676eebfdcf76d13f2a061c1686\"}, \"mark\": {\"type\": \"rule\", \"color\": \"gray\", \"strokeWidth\": 1}, \"encoding\": {\"x\": {\"field\": \"x\", \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-96d617e279b940cb811ebf063eb8b596\"}, \"mark\": {\"type\": \"text\", \"fontSize\": 16, \"fontWeight\": \"bold\"}, \"encoding\": {\"text\": {\"field\": \"label\", \"type\": \"nominal\"}, \"x\": {\"field\": \"x\", \"type\": \"quantitative\"}, \"y\": {\"field\": \"y\", \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-001d68cc8d2bc376c046ef92b3582b22\"}, \"mark\": {\"type\": \"text\", \"fontSize\": 14}, \"encoding\": {\"text\": {\"field\": \"label\", \"type\": \"nominal\"}, \"x\": {\"field\": \"x\", \"type\": \"quantitative\"}, \"y\": {\"field\": \"y\", \"type\": \"quantitative\"}}}], \"$schema\": \"https://vega.github.io/schema/vega-lite/v6.1.0.json\", \"datasets\": {\"data-799be74ece45aad5bdfca780af67b29c\": [{\"SampleID\": \"CU1\", \"Coverage\": 125.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\", \"x_position\": 0}, {\"SampleID\": \"CU2\", \"Coverage\": 138.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\", \"x_position\": 1}, {\"SampleID\": \"CU3\", \"Coverage\": 118.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\", \"x_position\": 2}, {\"SampleID\": \"CA1\", \"Coverage\": 94.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\", \"x_position\": 4}, {\"SampleID\": \"CA2\", \"Coverage\": 111.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\", \"x_position\": 5}, {\"SampleID\": \"CA3\", \"Coverage\": 31.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\", \"x_position\": 6}, {\"SampleID\": \"GU1\", \"Coverage\": 98.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\", \"x_position\": 10}, {\"SampleID\": \"GU2\", \"Coverage\": 70.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\", \"x_position\": 11}, {\"SampleID\": \"GU3\", \"Coverage\": 94.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\", \"x_position\": 12}, {\"SampleID\": \"GA1\", \"Coverage\": 62.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\", \"x_position\": 14}, {\"SampleID\": \"GA2\", \"Coverage\": 84.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\", \"x_position\": 15}, {\"SampleID\": \"GA3\", \"Coverage\": 99.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\", \"x_position\": 16}], \"data-aa5469676eebfdcf76d13f2a061c1686\": [{\"x\": 8}], \"data-96d617e279b940cb811ebf063eb8b596\": [{\"x\": 3, \"y\": 162, \"label\": \"cfDNA\"}, {\"x\": 13, \"y\": 162, \"label\": \"gDNA\"}], \"data-001d68cc8d2bc376c046ef92b3582b22\": [{\"x\": 1, \"y\": -8, \"label\": \"UMBS\"}, {\"x\": 5, \"y\": -8, \"label\": \"SBS\"}, {\"x\": 11, \"y\": -8, \"label\": \"UMBS\"}, {\"x\": 15, \"y\": -8, \"label\": \"SBS\"}]}}, {\"mode\": \"vega-lite\"});\n",
       "</script>"
      ],
      "text/plain": [
       "alt.LayerChart(...)"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df2_positioned = df2.with_columns(\n",
    "    pl.when(pl.col('SampleID') == 'CU1').then(pl.lit(0))\n",
    "      .when(pl.col('SampleID') == 'CU2').then(pl.lit(1))\n",
    "      .when(pl.col('SampleID') == 'CU3').then(pl.lit(2))\n",
    "      .when(pl.col('SampleID') == 'CA1').then(pl.lit(4))\n",
    "      .when(pl.col('SampleID') == 'CA2').then(pl.lit(5))\n",
    "      .when(pl.col('SampleID') == 'CA3').then(pl.lit(6))\n",
    "      .when(pl.col('SampleID') == 'GU1').then(pl.lit(10))\n",
    "      .when(pl.col('SampleID') == 'GU2').then(pl.lit(11))\n",
    "      .when(pl.col('SampleID') == 'GU3').then(pl.lit(12))\n",
    "      .when(pl.col('SampleID') == 'GA1').then(pl.lit(14))\n",
    "      .when(pl.col('SampleID') == 'GA2').then(pl.lit(15))\n",
    "      .when(pl.col('SampleID') == 'GA3').then(pl.lit(16))\n",
    "      .alias('x_position')\n",
    ")\n",
    "\n",
    "bars = alt.Chart(df2_positioned).mark_bar(width=12).encode(\n",
    "    x=alt.X('x_position:Q', \n",
    "            title=None,\n",
    "            axis=alt.Axis(labels=False, ticks=False, grid=False, domain=False),\n",
    "            scale=alt.Scale(domain=[-1.5, 17.5])),\n",
    "    y=alt.Y('Coverage:Q', \n",
    "            title='Coverage',\n",
    "            scale=alt.Scale(domain=[0, 170]),\n",
    "            axis=alt.Axis(grid=False)),\n",
    "    color=alt.Color('Treatment:N', title='Treatment')\n",
    ")\n",
    "\n",
    "divider = alt.Chart(pl.DataFrame({'x': [8]})).mark_rule(\n",
    "    color='gray',\n",
    "    strokeWidth=1\n",
    ").encode(x=alt.X('x:Q'))\n",
    "\n",
    "top_labels = alt.Chart(pl.DataFrame({\n",
    "    'x': [3, 13],\n",
    "    'y': [162, 162],\n",
    "    'label': ['cfDNA', 'gDNA']\n",
    "})).mark_text(fontSize=16, fontWeight='bold').encode(\n",
    "    x=alt.X('x:Q'),\n",
    "    y=alt.Y('y:Q'),\n",
    "    text='label:N'\n",
    ")\n",
    "\n",
    "treatment_labels = alt.Chart(pl.DataFrame({\n",
    "    'x': [1, 5, 11, 15],\n",
    "    'y': [-8, -8, -8, -8],\n",
    "    'label': ['UMBS', 'SBS', 'UMBS', 'SBS']\n",
    "})).mark_text(fontSize=14).encode(\n",
    "    x=alt.X('x:Q'),\n",
    "    y=alt.Y('y:Q'),\n",
    "    text='label:N'\n",
    ")\n",
    "\n",
    "chart = (bars + divider + top_labels + treatment_labels).properties(\n",
    "    width=600,\n",
    "    height=400\n",
    ").configure_view(\n",
    "    stroke='gray',\n",
    "    strokeWidth=2\n",
    ")\n",
    "\n",
    "chart"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "‚úÖ Continuing Claude session with execution results...\n",
      "\n",
      "============================================================\n",
      "ü§ñ Claude wants to execute code\n",
      "------------------------------------------------------------\n",
      "üìã To approve: Run the cell below\n",
      "‚û°Ô∏è To continue Claude agentically afterward: Run %cc\n",
      "============================================================\n",
      "\n",
      "üí≠ Claude: I'll increase the bar width by 50% (from 12 to 18 pixels).\n",
      "‚è∫ CreateNotebookCell\n",
      "üí≠ Claude: No response requested.\n"
     ]
    }
   ],
   "source": [
    "%cc Widen all bars by 50% "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "<style>\n",
       "  #altair-viz-337dbfcb29584d89984ac8d1abd646aa.vega-embed {\n",
       "    width: 100%;\n",
       "    display: flex;\n",
       "  }\n",
       "\n",
       "  #altair-viz-337dbfcb29584d89984ac8d1abd646aa.vega-embed details,\n",
       "  #altair-viz-337dbfcb29584d89984ac8d1abd646aa.vega-embed details summary {\n",
       "    position: relative;\n",
       "  }\n",
       "</style>\n",
       "<div id=\"altair-viz-337dbfcb29584d89984ac8d1abd646aa\"></div>\n",
       "<script type=\"text/javascript\">\n",
       "  var VEGA_DEBUG = (typeof VEGA_DEBUG == \"undefined\") ? {} : VEGA_DEBUG;\n",
       "  (function(spec, embedOpt){\n",
       "    let outputDiv = document.currentScript.previousElementSibling;\n",
       "    if (outputDiv.id !== \"altair-viz-337dbfcb29584d89984ac8d1abd646aa\") {\n",
       "      outputDiv = document.getElementById(\"altair-viz-337dbfcb29584d89984ac8d1abd646aa\");\n",
       "    }\n",
       "\n",
       "    const paths = {\n",
       "      \"vega\": \"https://cdn.jsdelivr.net/npm/vega@6?noext\",\n",
       "      \"vega-lib\": \"https://cdn.jsdelivr.net/npm/vega-lib?noext\",\n",
       "      \"vega-lite\": \"https://cdn.jsdelivr.net/npm/vega-lite@6.1.0?noext\",\n",
       "      \"vega-embed\": \"https://cdn.jsdelivr.net/npm/vega-embed@7?noext\",\n",
       "    };\n",
       "\n",
       "    function maybeLoadScript(lib, version) {\n",
       "      var key = `${lib.replace(\"-\", \"\")}_version`;\n",
       "      return (VEGA_DEBUG[key] == version) ?\n",
       "        Promise.resolve(paths[lib]) :\n",
       "        new Promise(function(resolve, reject) {\n",
       "          var s = document.createElement('script');\n",
       "          document.getElementsByTagName(\"head\")[0].appendChild(s);\n",
       "          s.async = true;\n",
       "          s.onload = () => {\n",
       "            VEGA_DEBUG[key] = version;\n",
       "            return resolve(paths[lib]);\n",
       "          };\n",
       "          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);\n",
       "          s.src = paths[lib];\n",
       "        });\n",
       "    }\n",
       "\n",
       "    function showError(err) {\n",
       "      outputDiv.innerHTML = `<div class=\"error\" style=\"color:red;\">${err}</div>`;\n",
       "      throw err;\n",
       "    }\n",
       "\n",
       "    function displayChart(vegaEmbed) {\n",
       "      vegaEmbed(outputDiv, spec, embedOpt)\n",
       "        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));\n",
       "    }\n",
       "\n",
       "    if(typeof define === \"function\" && define.amd) {\n",
       "      requirejs.config({paths});\n",
       "      let deps = [\"vega-embed\"];\n",
       "      require(deps, displayChart, err => showError(`Error loading script: ${err.message}`));\n",
       "    } else {\n",
       "      maybeLoadScript(\"vega\", \"6\")\n",
       "        .then(() => maybeLoadScript(\"vega-lite\", \"6.1.0\"))\n",
       "        .then(() => maybeLoadScript(\"vega-embed\", \"7\"))\n",
       "        .catch(showError)\n",
       "        .then(() => displayChart(vegaEmbed));\n",
       "    }\n",
       "  })({\"width\": 600, \"height\": 400, \"config\": {\"axisX\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"titleFontWeight\": 100, \"labelAngle\": 0, \"labelFont\": \"\", \"titleFont\": \"\"}, \"axisY\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"titleFontWeight\": 100, \"labelAngle\": 0, \"labelFont\": \"\", \"titleFont\": \"\"}, \"title\": {\"fontSize\": 25, \"fontWeight\": 200, \"offset\": 20, \"font\": \"\"}, \"legend\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"symbolSize\": 600, \"titleFontWeight\": 200, \"labelFont\": \"\", \"titleFont\": \"\"}, \"text\": {\"font\": \"\", \"fontWeight\": 100}, \"view\": {\"stroke\": \"gray\", \"strokeWidth\": 2}}, \"layer\": [{\"data\": {\"name\": \"data-799be74ece45aad5bdfca780af67b29c\"}, \"mark\": {\"type\": \"bar\", \"width\": 18}, \"encoding\": {\"color\": {\"field\": \"Treatment\", \"sort\": [\"UMBS\", \"SBS\"], \"title\": \"Treatment\", \"type\": \"nominal\"}, \"x\": {\"axis\": {\"domain\": false, \"grid\": false, \"labels\": false, \"ticks\": false}, \"field\": \"x_position\", \"scale\": {\"domain\": [-0.3, 16.3]}, \"title\": null, \"type\": \"quantitative\"}, \"y\": {\"axis\": {\"grid\": false}, \"field\": \"Coverage\", \"scale\": {\"domain\": [0, 170]}, \"title\": \"Coverage\", \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-aa5469676eebfdcf76d13f2a061c1686\"}, \"mark\": {\"type\": \"rule\", \"color\": \"gray\", \"strokeWidth\": 1}, \"encoding\": {\"x\": {\"field\": \"x\", \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-96d617e279b940cb811ebf063eb8b596\"}, \"mark\": {\"type\": \"text\", \"fontSize\": 16}, \"encoding\": {\"text\": {\"field\": \"label\", \"type\": \"nominal\"}, \"x\": {\"field\": \"x\", \"type\": \"quantitative\"}, \"y\": {\"field\": \"y\", \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-001d68cc8d2bc376c046ef92b3582b22\"}, \"mark\": {\"type\": \"text\", \"fontSize\": 14}, \"encoding\": {\"text\": {\"field\": \"label\", \"type\": \"nominal\"}, \"x\": {\"field\": \"x\", \"type\": \"quantitative\"}, \"y\": {\"field\": \"y\", \"type\": \"quantitative\"}}}], \"$schema\": \"https://vega.github.io/schema/vega-lite/v6.1.0.json\", \"datasets\": {\"data-799be74ece45aad5bdfca780af67b29c\": [{\"SampleID\": \"CU1\", \"Coverage\": 125.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\", \"x_position\": 0}, {\"SampleID\": \"CU2\", \"Coverage\": 138.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\", \"x_position\": 1}, {\"SampleID\": \"CU3\", \"Coverage\": 118.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\", \"x_position\": 2}, {\"SampleID\": \"CA1\", \"Coverage\": 94.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\", \"x_position\": 4}, {\"SampleID\": \"CA2\", \"Coverage\": 111.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\", \"x_position\": 5}, {\"SampleID\": \"CA3\", \"Coverage\": 31.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\", \"x_position\": 6}, {\"SampleID\": \"GU1\", \"Coverage\": 98.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\", \"x_position\": 10}, {\"SampleID\": \"GU2\", \"Coverage\": 70.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\", \"x_position\": 11}, {\"SampleID\": \"GU3\", \"Coverage\": 94.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\", \"x_position\": 12}, {\"SampleID\": \"GA1\", \"Coverage\": 62.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\", \"x_position\": 14}, {\"SampleID\": \"GA2\", \"Coverage\": 84.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\", \"x_position\": 15}, {\"SampleID\": \"GA3\", \"Coverage\": 99.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\", \"x_position\": 16}], \"data-aa5469676eebfdcf76d13f2a061c1686\": [{\"x\": 8}], \"data-96d617e279b940cb811ebf063eb8b596\": [{\"x\": 3, \"y\": 162, \"label\": \"cfDNA\"}, {\"x\": 13, \"y\": 162, \"label\": \"gDNA\"}], \"data-001d68cc8d2bc376c046ef92b3582b22\": [{\"x\": 1, \"y\": -8, \"label\": \"UMBS\"}, {\"x\": 5, \"y\": -8, \"label\": \"SBS\"}, {\"x\": 11, \"y\": -8, \"label\": \"UMBS\"}, {\"x\": 15, \"y\": -8, \"label\": \"SBS\"}]}}, {\"mode\": \"vega-lite\"});\n",
       "</script>"
      ],
      "text/plain": [
       "alt.LayerChart(...)"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "bars = alt.Chart(df2_positioned).mark_bar(width=18).encode(\n",
    "    x=alt.X('x_position:Q', \n",
    "            title=None,\n",
    "            axis=alt.Axis(labels=False, ticks=False, grid=False, domain=False),\n",
    "            scale=alt.Scale(domain=[-0.3, 16.3])),\n",
    "    y=alt.Y('Coverage:Q', \n",
    "            title='Coverage',\n",
    "            scale=alt.Scale(domain=[0, 170]),\n",
    "            axis=alt.Axis(grid=False)),\n",
    "    color=alt.Color('Treatment:N', title='Treatment')\n",
    ")\n",
    "\n",
    "divider = alt.Chart(pl.DataFrame({'x': [8]})).mark_rule(\n",
    "    color='gray',\n",
    "    strokeWidth=1\n",
    ").encode(x=alt.X('x:Q'))\n",
    "\n",
    "top_labels = alt.Chart(pl.DataFrame({\n",
    "    'x': [3, 13],\n",
    "    'y': [162, 162],\n",
    "    'label': ['cfDNA', 'gDNA']\n",
    "})).mark_text(fontSize=16).encode(\n",
    "    x=alt.X('x:Q'),\n",
    "    y=alt.Y('y:Q'),\n",
    "    text='label:N'\n",
    ")\n",
    "\n",
    "treatment_labels = alt.Chart(pl.DataFrame({\n",
    "    'x': [1, 5, 11, 15],\n",
    "    'y': [-8, -8, -8, -8],\n",
    "    'label': ['UMBS', 'SBS', 'UMBS', 'SBS']\n",
    "})).mark_text(fontSize=14).encode(\n",
    "    x=alt.X('x:Q'),\n",
    "    y=alt.Y('y:Q'),\n",
    "    text='label:N'\n",
    ")\n",
    "\n",
    "chart = (bars + divider + top_labels + treatment_labels).properties(\n",
    "    width=600,\n",
    "    height=400\n",
    ").configure_view(\n",
    "    stroke='gray',\n",
    "    strokeWidth=2\n",
    ")\n",
    "\n",
    "chart"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "‚úÖ Continuing Claude session with execution results...\n",
      "\n",
      "============================================================\n",
      "ü§ñ Claude wants to execute code\n",
      "------------------------------------------------------------\n",
      "üìã To approve: Run the cell below\n",
      "‚û°Ô∏è To continue Claude agentically afterward: Run %cc\n",
      "============================================================\n",
      "\n",
      "üí≠ Claude: I'll modify the color encoding to specify the legend order with UMBS first, then SBS.\n",
      "‚è∫ CreateNotebookCell\n",
      "üí≠ Claude: No response requested.\n"
     ]
    }
   ],
   "source": [
    "%cc Change order of Color legend. It should be \"UMBS\" the \"SBS\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "<style>\n",
       "  #altair-viz-00f973f7708b4337b0f5ea3cae19c0ba.vega-embed {\n",
       "    width: 100%;\n",
       "    display: flex;\n",
       "  }\n",
       "\n",
       "  #altair-viz-00f973f7708b4337b0f5ea3cae19c0ba.vega-embed details,\n",
       "  #altair-viz-00f973f7708b4337b0f5ea3cae19c0ba.vega-embed details summary {\n",
       "    position: relative;\n",
       "  }\n",
       "</style>\n",
       "<div id=\"altair-viz-00f973f7708b4337b0f5ea3cae19c0ba\"></div>\n",
       "<script type=\"text/javascript\">\n",
       "  var VEGA_DEBUG = (typeof VEGA_DEBUG == \"undefined\") ? {} : VEGA_DEBUG;\n",
       "  (function(spec, embedOpt){\n",
       "    let outputDiv = document.currentScript.previousElementSibling;\n",
       "    if (outputDiv.id !== \"altair-viz-00f973f7708b4337b0f5ea3cae19c0ba\") {\n",
       "      outputDiv = document.getElementById(\"altair-viz-00f973f7708b4337b0f5ea3cae19c0ba\");\n",
       "    }\n",
       "\n",
       "    const paths = {\n",
       "      \"vega\": \"https://cdn.jsdelivr.net/npm/vega@6?noext\",\n",
       "      \"vega-lib\": \"https://cdn.jsdelivr.net/npm/vega-lib?noext\",\n",
       "      \"vega-lite\": \"https://cdn.jsdelivr.net/npm/vega-lite@6.1.0?noext\",\n",
       "      \"vega-embed\": \"https://cdn.jsdelivr.net/npm/vega-embed@7?noext\",\n",
       "    };\n",
       "\n",
       "    function maybeLoadScript(lib, version) {\n",
       "      var key = `${lib.replace(\"-\", \"\")}_version`;\n",
       "      return (VEGA_DEBUG[key] == version) ?\n",
       "        Promise.resolve(paths[lib]) :\n",
       "        new Promise(function(resolve, reject) {\n",
       "          var s = document.createElement('script');\n",
       "          document.getElementsByTagName(\"head\")[0].appendChild(s);\n",
       "          s.async = true;\n",
       "          s.onload = () => {\n",
       "            VEGA_DEBUG[key] = version;\n",
       "            return resolve(paths[lib]);\n",
       "          };\n",
       "          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);\n",
       "          s.src = paths[lib];\n",
       "        });\n",
       "    }\n",
       "\n",
       "    function showError(err) {\n",
       "      outputDiv.innerHTML = `<div class=\"error\" style=\"color:red;\">${err}</div>`;\n",
       "      throw err;\n",
       "    }\n",
       "\n",
       "    function displayChart(vegaEmbed) {\n",
       "      vegaEmbed(outputDiv, spec, embedOpt)\n",
       "        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));\n",
       "    }\n",
       "\n",
       "    if(typeof define === \"function\" && define.amd) {\n",
       "      requirejs.config({paths});\n",
       "      let deps = [\"vega-embed\"];\n",
       "      require(deps, displayChart, err => showError(`Error loading script: ${err.message}`));\n",
       "    } else {\n",
       "      maybeLoadScript(\"vega\", \"6\")\n",
       "        .then(() => maybeLoadScript(\"vega-lite\", \"6.1.0\"))\n",
       "        .then(() => maybeLoadScript(\"vega-embed\", \"7\"))\n",
       "        .catch(showError)\n",
       "        .then(() => displayChart(vegaEmbed));\n",
       "    }\n",
       "  })({\"width\": 600, \"height\": 400, \"config\": {\"axisX\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"titleFontWeight\": 100, \"labelAngle\": 0, \"labelFont\": \"\", \"titleFont\": \"\"}, \"axisY\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"titleFontWeight\": 100, \"labelAngle\": 0, \"labelFont\": \"\", \"titleFont\": \"\"}, \"title\": {\"fontSize\": 25, \"fontWeight\": 200, \"offset\": 20, \"font\": \"\"}, \"legend\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"symbolSize\": 600, \"titleFontWeight\": 200, \"labelFont\": \"\", \"titleFont\": \"\"}, \"text\": {\"font\": \"\", \"fontWeight\": 100}, \"view\": {\"stroke\": \"gray\", \"strokeWidth\": 2}}, \"layer\": [{\"data\": {\"name\": \"data-799be74ece45aad5bdfca780af67b29c\"}, \"mark\": {\"type\": \"bar\", \"width\": 18}, \"encoding\": {\"color\": {\"field\": \"Treatment\", \"legend\": null, \"sort\": [\"UMBS\", \"SBS\"], \"title\": \"Treatment\", \"type\": \"nominal\"}, \"x\": {\"axis\": {\"domain\": false, \"grid\": false, \"labels\": false, \"ticks\": false}, \"field\": \"x_position\", \"scale\": {\"domain\": [-0.3, 16.3]}, \"title\": null, \"type\": \"quantitative\"}, \"y\": {\"axis\": {\"grid\": false}, \"field\": \"Coverage\", \"scale\": {\"domain\": [0, 170]}, \"title\": \"Coverage\", \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-aa5469676eebfdcf76d13f2a061c1686\"}, \"mark\": {\"type\": \"rule\", \"color\": \"gray\", \"strokeWidth\": 1}, \"encoding\": {\"x\": {\"field\": \"x\", \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-96d617e279b940cb811ebf063eb8b596\"}, \"mark\": {\"type\": \"text\", \"fontSize\": 16}, \"encoding\": {\"text\": {\"field\": \"label\", \"type\": \"nominal\"}, \"x\": {\"field\": \"x\", \"type\": \"quantitative\"}, \"y\": {\"field\": \"y\", \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-001d68cc8d2bc376c046ef92b3582b22\"}, \"mark\": {\"type\": \"text\", \"fontSize\": 14}, \"encoding\": {\"text\": {\"field\": \"label\", \"type\": \"nominal\"}, \"x\": {\"field\": \"x\", \"type\": \"quantitative\"}, \"y\": {\"field\": \"y\", \"type\": \"quantitative\"}}}], \"$schema\": \"https://vega.github.io/schema/vega-lite/v6.1.0.json\", \"datasets\": {\"data-799be74ece45aad5bdfca780af67b29c\": [{\"SampleID\": \"CU1\", \"Coverage\": 125.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\", \"x_position\": 0}, {\"SampleID\": \"CU2\", \"Coverage\": 138.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\", \"x_position\": 1}, {\"SampleID\": \"CU3\", \"Coverage\": 118.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\", \"x_position\": 2}, {\"SampleID\": \"CA1\", \"Coverage\": 94.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\", \"x_position\": 4}, {\"SampleID\": \"CA2\", \"Coverage\": 111.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\", \"x_position\": 5}, {\"SampleID\": \"CA3\", \"Coverage\": 31.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\", \"x_position\": 6}, {\"SampleID\": \"GU1\", \"Coverage\": 98.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\", \"x_position\": 10}, {\"SampleID\": \"GU2\", \"Coverage\": 70.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\", \"x_position\": 11}, {\"SampleID\": \"GU3\", \"Coverage\": 94.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\", \"x_position\": 12}, {\"SampleID\": \"GA1\", \"Coverage\": 62.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\", \"x_position\": 14}, {\"SampleID\": \"GA2\", \"Coverage\": 84.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\", \"x_position\": 15}, {\"SampleID\": \"GA3\", \"Coverage\": 99.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\", \"x_position\": 16}], \"data-aa5469676eebfdcf76d13f2a061c1686\": [{\"x\": 8}], \"data-96d617e279b940cb811ebf063eb8b596\": [{\"x\": 3, \"y\": 162, \"label\": \"cfDNA\"}, {\"x\": 13, \"y\": 162, \"label\": \"gDNA\"}], \"data-001d68cc8d2bc376c046ef92b3582b22\": [{\"x\": 1, \"y\": -8, \"label\": \"UMBS\"}, {\"x\": 5, \"y\": -8, \"label\": \"SBS\"}, {\"x\": 11, \"y\": -8, \"label\": \"UMBS\"}, {\"x\": 15, \"y\": -8, \"label\": \"SBS\"}]}}, {\"mode\": \"vega-lite\"});\n",
       "</script>"
      ],
      "text/plain": [
       "alt.LayerChart(...)"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "bars = alt.Chart(df2_positioned).mark_bar(width=18).encode(\n",
    "    x=alt.X('x_position:Q', \n",
    "            title=None,\n",
    "            axis=alt.Axis(labels=False, ticks=False, grid=False, domain=False),\n",
    "            scale=alt.Scale(domain=[-0.3, 16.3])),\n",
    "    y=alt.Y('Coverage:Q', \n",
    "            title='Coverage',\n",
    "            scale=alt.Scale(domain=[0, 170]),\n",
    "            axis=alt.Axis(grid=False)),\n",
    "    color=alt.Color('Treatment:N', \n",
    "                    title='Treatment',\n",
    "                    sort=['UMBS', 'SBS'],\n",
    "                    legend=None)\n",
    ")\n",
    "\n",
    "divider = alt.Chart(pl.DataFrame({'x': [8]})).mark_rule(\n",
    "    color='gray',\n",
    "    strokeWidth=1\n",
    ").encode(x=alt.X('x:Q'))\n",
    "\n",
    "top_labels = alt.Chart(pl.DataFrame({\n",
    "    'x': [3, 13],\n",
    "    'y': [162, 162],\n",
    "    'label': ['cfDNA', 'gDNA']\n",
    "})).mark_text(fontSize=16).encode(\n",
    "    x=alt.X('x:Q'),\n",
    "    y=alt.Y('y:Q'),\n",
    "    text='label:N'\n",
    ")\n",
    "\n",
    "treatment_labels = alt.Chart(pl.DataFrame({\n",
    "    'x': [1, 5, 11, 15],\n",
    "    'y': [-8, -8, -8, -8],\n",
    "    'label': ['UMBS', 'SBS', 'UMBS', 'SBS']\n",
    "})).mark_text(fontSize=14).encode(\n",
    "    x=alt.X('x:Q'),\n",
    "    y=alt.Y('y:Q'),\n",
    "    text='label:N'\n",
    ")\n",
    "\n",
    "chart = (bars + divider + top_labels + treatment_labels).properties(\n",
    "    width=600,\n",
    "    height=400\n",
    ").configure_view(\n",
    "    stroke='gray',\n",
    "    strokeWidth=2\n",
    ")\n",
    "\n",
    "chart"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "============================================================\n",
      "ü§ñ Claude wants to execute code\n",
      "------------------------------------------------------------\n",
      "üìã To approve: Run the cell below\n",
      "‚û°Ô∏è To continue Claude agentically afterward: Run %cc\n",
      "============================================================\n",
      "\n",
      "üí≠ Claude: I'll add text labels showing the coverage values as integers on top of each bar.\n",
      "‚è∫ CreateNotebookCell\n",
      "üí≠ Claude: No response requested.\n"
     ]
    }
   ],
   "source": [
    "%cc Add coverage value the top of each bar as Integer. Regular font"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "<style>\n",
       "  #altair-viz-ae4bc8c4922c44e59c3cba7c21c61cb0.vega-embed {\n",
       "    width: 100%;\n",
       "    display: flex;\n",
       "  }\n",
       "\n",
       "  #altair-viz-ae4bc8c4922c44e59c3cba7c21c61cb0.vega-embed details,\n",
       "  #altair-viz-ae4bc8c4922c44e59c3cba7c21c61cb0.vega-embed details summary {\n",
       "    position: relative;\n",
       "  }\n",
       "</style>\n",
       "<div id=\"altair-viz-ae4bc8c4922c44e59c3cba7c21c61cb0\"></div>\n",
       "<script type=\"text/javascript\">\n",
       "  var VEGA_DEBUG = (typeof VEGA_DEBUG == \"undefined\") ? {} : VEGA_DEBUG;\n",
       "  (function(spec, embedOpt){\n",
       "    let outputDiv = document.currentScript.previousElementSibling;\n",
       "    if (outputDiv.id !== \"altair-viz-ae4bc8c4922c44e59c3cba7c21c61cb0\") {\n",
       "      outputDiv = document.getElementById(\"altair-viz-ae4bc8c4922c44e59c3cba7c21c61cb0\");\n",
       "    }\n",
       "\n",
       "    const paths = {\n",
       "      \"vega\": \"https://cdn.jsdelivr.net/npm/vega@6?noext\",\n",
       "      \"vega-lib\": \"https://cdn.jsdelivr.net/npm/vega-lib?noext\",\n",
       "      \"vega-lite\": \"https://cdn.jsdelivr.net/npm/vega-lite@6.1.0?noext\",\n",
       "      \"vega-embed\": \"https://cdn.jsdelivr.net/npm/vega-embed@7?noext\",\n",
       "    };\n",
       "\n",
       "    function maybeLoadScript(lib, version) {\n",
       "      var key = `${lib.replace(\"-\", \"\")}_version`;\n",
       "      return (VEGA_DEBUG[key] == version) ?\n",
       "        Promise.resolve(paths[lib]) :\n",
       "        new Promise(function(resolve, reject) {\n",
       "          var s = document.createElement('script');\n",
       "          document.getElementsByTagName(\"head\")[0].appendChild(s);\n",
       "          s.async = true;\n",
       "          s.onload = () => {\n",
       "            VEGA_DEBUG[key] = version;\n",
       "            return resolve(paths[lib]);\n",
       "          };\n",
       "          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);\n",
       "          s.src = paths[lib];\n",
       "        });\n",
       "    }\n",
       "\n",
       "    function showError(err) {\n",
       "      outputDiv.innerHTML = `<div class=\"error\" style=\"color:red;\">${err}</div>`;\n",
       "      throw err;\n",
       "    }\n",
       "\n",
       "    function displayChart(vegaEmbed) {\n",
       "      vegaEmbed(outputDiv, spec, embedOpt)\n",
       "        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));\n",
       "    }\n",
       "\n",
       "    if(typeof define === \"function\" && define.amd) {\n",
       "      requirejs.config({paths});\n",
       "      let deps = [\"vega-embed\"];\n",
       "      require(deps, displayChart, err => showError(`Error loading script: ${err.message}`));\n",
       "    } else {\n",
       "      maybeLoadScript(\"vega\", \"6\")\n",
       "        .then(() => maybeLoadScript(\"vega-lite\", \"6.1.0\"))\n",
       "        .then(() => maybeLoadScript(\"vega-embed\", \"7\"))\n",
       "        .catch(showError)\n",
       "        .then(() => displayChart(vegaEmbed));\n",
       "    }\n",
       "  })({\"width\": 600, \"height\": 400, \"config\": {\"axisX\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"titleFontWeight\": 100, \"labelAngle\": 0, \"labelFont\": \"\", \"titleFont\": \"\"}, \"axisY\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"titleFontWeight\": 100, \"labelAngle\": 0, \"labelFont\": \"\", \"titleFont\": \"\"}, \"title\": {\"fontSize\": 25, \"fontWeight\": 200, \"offset\": 20, \"font\": \"\"}, \"legend\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"symbolSize\": 600, \"titleFontWeight\": 200, \"labelFont\": \"\", \"titleFont\": \"\"}, \"text\": {\"font\": \"\", \"fontWeight\": 100}, \"view\": {\"stroke\": \"gray\", \"strokeWidth\": 2}}, \"layer\": [{\"mark\": {\"type\": \"bar\", \"width\": 18}, \"encoding\": {\"color\": {\"field\": \"Treatment\", \"legend\": null, \"sort\": [\"UMBS\", \"SBS\"], \"title\": \"Treatment\", \"type\": \"nominal\"}, \"x\": {\"axis\": {\"domain\": false, \"grid\": false, \"labels\": false, \"ticks\": false}, \"field\": \"x_position\", \"scale\": {\"domain\": [-0.3, 16.3]}, \"title\": null, \"type\": \"quantitative\"}, \"y\": {\"axis\": {\"grid\": false}, \"field\": \"Coverage\", \"scale\": {\"domain\": [0, 170]}, \"title\": \"Coverage\", \"type\": \"quantitative\"}}}, {\"mark\": {\"type\": \"text\", \"dy\": -8, \"fontSize\": 12}, \"encoding\": {\"text\": {\"field\": \"Coverage\", \"format\": \".0f\", \"type\": \"quantitative\"}, \"x\": {\"field\": \"x_position\", \"type\": \"quantitative\"}, \"y\": {\"field\": \"Coverage\", \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-aa5469676eebfdcf76d13f2a061c1686\"}, \"mark\": {\"type\": \"rule\", \"color\": \"gray\", \"strokeWidth\": 1}, \"encoding\": {\"x\": {\"field\": \"x\", \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-96d617e279b940cb811ebf063eb8b596\"}, \"mark\": {\"type\": \"text\", \"fontSize\": 16}, \"encoding\": {\"text\": {\"field\": \"label\", \"type\": \"nominal\"}, \"x\": {\"field\": \"x\", \"type\": \"quantitative\"}, \"y\": {\"field\": \"y\", \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-001d68cc8d2bc376c046ef92b3582b22\"}, \"mark\": {\"type\": \"text\", \"fontSize\": 14}, \"encoding\": {\"text\": {\"field\": \"label\", \"type\": \"nominal\"}, \"x\": {\"field\": \"x\", \"type\": \"quantitative\"}, \"y\": {\"field\": \"y\", \"type\": \"quantitative\"}}}], \"data\": {\"name\": \"data-799be74ece45aad5bdfca780af67b29c\"}, \"$schema\": \"https://vega.github.io/schema/vega-lite/v6.1.0.json\", \"datasets\": {\"data-799be74ece45aad5bdfca780af67b29c\": [{\"SampleID\": \"CU1\", \"Coverage\": 125.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\", \"x_position\": 0}, {\"SampleID\": \"CU2\", \"Coverage\": 138.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\", \"x_position\": 1}, {\"SampleID\": \"CU3\", \"Coverage\": 118.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\", \"x_position\": 2}, {\"SampleID\": \"CA1\", \"Coverage\": 94.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\", \"x_position\": 4}, {\"SampleID\": \"CA2\", \"Coverage\": 111.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\", \"x_position\": 5}, {\"SampleID\": \"CA3\", \"Coverage\": 31.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\", \"x_position\": 6}, {\"SampleID\": \"GU1\", \"Coverage\": 98.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\", \"x_position\": 10}, {\"SampleID\": \"GU2\", \"Coverage\": 70.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\", \"x_position\": 11}, {\"SampleID\": \"GU3\", \"Coverage\": 94.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\", \"x_position\": 12}, {\"SampleID\": \"GA1\", \"Coverage\": 62.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\", \"x_position\": 14}, {\"SampleID\": \"GA2\", \"Coverage\": 84.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\", \"x_position\": 15}, {\"SampleID\": \"GA3\", \"Coverage\": 99.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\", \"x_position\": 16}], \"data-aa5469676eebfdcf76d13f2a061c1686\": [{\"x\": 8}], \"data-96d617e279b940cb811ebf063eb8b596\": [{\"x\": 3, \"y\": 162, \"label\": \"cfDNA\"}, {\"x\": 13, \"y\": 162, \"label\": \"gDNA\"}], \"data-001d68cc8d2bc376c046ef92b3582b22\": [{\"x\": 1, \"y\": -8, \"label\": \"UMBS\"}, {\"x\": 5, \"y\": -8, \"label\": \"SBS\"}, {\"x\": 11, \"y\": -8, \"label\": \"UMBS\"}, {\"x\": 15, \"y\": -8, \"label\": \"SBS\"}]}}, {\"mode\": \"vega-lite\"});\n",
       "</script>"
      ],
      "text/plain": [
       "alt.LayerChart(...)"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "bars = alt.Chart(df2_positioned).mark_bar(width=18).encode(\n",
    "    x=alt.X('x_position:Q', \n",
    "            title=None,\n",
    "            axis=alt.Axis(labels=False, ticks=False, grid=False, domain=False),\n",
    "            scale=alt.Scale(domain=[-0.3, 16.3])),\n",
    "    y=alt.Y('Coverage:Q', \n",
    "            title='Coverage',\n",
    "            scale=alt.Scale(domain=[0, 170]),\n",
    "            axis=alt.Axis(grid=False)),\n",
    "    color=alt.Color('Treatment:N', \n",
    "                    title='Treatment',\n",
    "                    sort=['UMBS', 'SBS'],\n",
    "                    legend=None)\n",
    ")\n",
    "\n",
    "value_labels = alt.Chart(df2_positioned).mark_text(dy=-8, fontSize=12).encode(\n",
    "    x=alt.X('x_position:Q'),\n",
    "    y=alt.Y('Coverage:Q'),\n",
    "    text=alt.Text('Coverage:Q', format='.0f')\n",
    ")\n",
    "\n",
    "divider = alt.Chart(pl.DataFrame({'x': [8]})).mark_rule(\n",
    "    color='gray',\n",
    "    strokeWidth=1\n",
    ").encode(x=alt.X('x:Q'))\n",
    "\n",
    "top_labels = alt.Chart(pl.DataFrame({\n",
    "    'x': [3, 13],\n",
    "    'y': [162, 162],\n",
    "    'label': ['cfDNA', 'gDNA']\n",
    "})).mark_text(fontSize=16).encode(\n",
    "    x=alt.X('x:Q'),\n",
    "    y=alt.Y('y:Q'),\n",
    "    text='label:N'\n",
    ")\n",
    "\n",
    "treatment_labels = alt.Chart(pl.DataFrame({\n",
    "    'x': [1, 5, 11, 15],\n",
    "    'y': [-8, -8, -8, -8],\n",
    "    'label': ['UMBS', 'SBS', 'UMBS', 'SBS']\n",
    "})).mark_text(fontSize=14).encode(\n",
    "    x=alt.X('x:Q'),\n",
    "    y=alt.Y('y:Q'),\n",
    "    text='label:N'\n",
    ")\n",
    "\n",
    "chart = (bars + value_labels + divider + top_labels + treatment_labels).properties(\n",
    "    width=600,\n",
    "    height=400\n",
    ").configure_view(\n",
    "    stroke='gray',\n",
    "    strokeWidth=2\n",
    ")\n",
    "\n",
    "chart"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "‚úÖ Continuing Claude session with execution results...\n",
      "\n",
      "============================================================\n",
      "ü§ñ Claude wants to execute code\n",
      "------------------------------------------------------------\n",
      "üìã To approve: Run the cell below\n",
      "‚û°Ô∏è To continue Claude agentically afterward: Run %cc\n",
      "============================================================\n",
      "\n",
      "üí≠ Claude: I'll increase the bar width by 15% (from 18 to approximately 20.7 pixels).\n",
      "‚è∫ CreateNotebookCell\n",
      "üí≠ Claude: No response requested.\n"
     ]
    }
   ],
   "source": [
    "%cc Increase bar widths by 15%"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "df2_positioned = df2.with_columns(\n",
    "    pl.when(pl.col('SampleID') == 'CU1').then(pl.lit(0))\n",
    "      .when(pl.col('SampleID') == 'CU2').then(pl.lit(1))\n",
    "      .when(pl.col('SampleID') == 'CU3').then(pl.lit(2))\n",
    "      .when(pl.col('SampleID') == 'CA1').then(pl.lit(4))\n",
    "      .when(pl.col('SampleID') == 'CA2').then(pl.lit(5))\n",
    "      .when(pl.col('SampleID') == 'CA3').then(pl.lit(6))\n",
    "      .when(pl.col('SampleID') == 'GU1').then(pl.lit(10))\n",
    "      .when(pl.col('SampleID') == 'GU2').then(pl.lit(11))\n",
    "      .when(pl.col('SampleID') == 'GU3').then(pl.lit(12))\n",
    "      .when(pl.col('SampleID') == 'GA1').then(pl.lit(14))\n",
    "      .when(pl.col('SampleID') == 'GA2').then(pl.lit(15))\n",
    "      .when(pl.col('SampleID') == 'GA3').then(pl.lit(16))\n",
    "      .alias('x_position')\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "<style>\n",
       "  #altair-viz-af046d99bae8443eae4a3f25fbcbe65c.vega-embed {\n",
       "    width: 100%;\n",
       "    display: flex;\n",
       "  }\n",
       "\n",
       "  #altair-viz-af046d99bae8443eae4a3f25fbcbe65c.vega-embed details,\n",
       "  #altair-viz-af046d99bae8443eae4a3f25fbcbe65c.vega-embed details summary {\n",
       "    position: relative;\n",
       "  }\n",
       "</style>\n",
       "<div id=\"altair-viz-af046d99bae8443eae4a3f25fbcbe65c\"></div>\n",
       "<script type=\"text/javascript\">\n",
       "  var VEGA_DEBUG = (typeof VEGA_DEBUG == \"undefined\") ? {} : VEGA_DEBUG;\n",
       "  (function(spec, embedOpt){\n",
       "    let outputDiv = document.currentScript.previousElementSibling;\n",
       "    if (outputDiv.id !== \"altair-viz-af046d99bae8443eae4a3f25fbcbe65c\") {\n",
       "      outputDiv = document.getElementById(\"altair-viz-af046d99bae8443eae4a3f25fbcbe65c\");\n",
       "    }\n",
       "\n",
       "    const paths = {\n",
       "      \"vega\": \"https://cdn.jsdelivr.net/npm/vega@6?noext\",\n",
       "      \"vega-lib\": \"https://cdn.jsdelivr.net/npm/vega-lib?noext\",\n",
       "      \"vega-lite\": \"https://cdn.jsdelivr.net/npm/vega-lite@6.1.0?noext\",\n",
       "      \"vega-embed\": \"https://cdn.jsdelivr.net/npm/vega-embed@7?noext\",\n",
       "    };\n",
       "\n",
       "    function maybeLoadScript(lib, version) {\n",
       "      var key = `${lib.replace(\"-\", \"\")}_version`;\n",
       "      return (VEGA_DEBUG[key] == version) ?\n",
       "        Promise.resolve(paths[lib]) :\n",
       "        new Promise(function(resolve, reject) {\n",
       "          var s = document.createElement('script');\n",
       "          document.getElementsByTagName(\"head\")[0].appendChild(s);\n",
       "          s.async = true;\n",
       "          s.onload = () => {\n",
       "            VEGA_DEBUG[key] = version;\n",
       "            return resolve(paths[lib]);\n",
       "          };\n",
       "          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);\n",
       "          s.src = paths[lib];\n",
       "        });\n",
       "    }\n",
       "\n",
       "    function showError(err) {\n",
       "      outputDiv.innerHTML = `<div class=\"error\" style=\"color:red;\">${err}</div>`;\n",
       "      throw err;\n",
       "    }\n",
       "\n",
       "    function displayChart(vegaEmbed) {\n",
       "      vegaEmbed(outputDiv, spec, embedOpt)\n",
       "        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));\n",
       "    }\n",
       "\n",
       "    if(typeof define === \"function\" && define.amd) {\n",
       "      requirejs.config({paths});\n",
       "      let deps = [\"vega-embed\"];\n",
       "      require(deps, displayChart, err => showError(`Error loading script: ${err.message}`));\n",
       "    } else {\n",
       "      maybeLoadScript(\"vega\", \"6\")\n",
       "        .then(() => maybeLoadScript(\"vega-lite\", \"6.1.0\"))\n",
       "        .then(() => maybeLoadScript(\"vega-embed\", \"7\"))\n",
       "        .catch(showError)\n",
       "        .then(() => displayChart(vegaEmbed));\n",
       "    }\n",
       "  })({\"width\": 600, \"height\": 400, \"config\": {\"axisX\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"titleFontWeight\": 100, \"labelAngle\": 0, \"labelFont\": \"\", \"titleFont\": \"\"}, \"axisY\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"titleFontWeight\": 100, \"labelAngle\": 0, \"labelFont\": \"\", \"titleFont\": \"\"}, \"title\": {\"fontSize\": 25, \"fontWeight\": 200, \"offset\": 20, \"font\": \"\"}, \"legend\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"symbolSize\": 600, \"titleFontWeight\": 200, \"labelFont\": \"\", \"titleFont\": \"\"}, \"text\": {\"font\": \"\", \"fontWeight\": 100}, \"view\": {\"stroke\": \"gray\", \"strokeWidth\": 2}}, \"layer\": [{\"mark\": {\"type\": \"bar\", \"width\": 21}, \"encoding\": {\"color\": {\"field\": \"Treatment\", \"legend\": null, \"scale\": {\"domain\": [\"UMBS\", \"SBS\"], \"range\": [\"#4c78a8\", \"#f58518\"]}, \"sort\": [\"UMBS\", \"SBS\"], \"title\": \"Treatment\", \"type\": \"nominal\"}, \"x\": {\"axis\": {\"domain\": false, \"grid\": false, \"labels\": false, \"ticks\": false}, \"field\": \"x_position\", \"scale\": {\"domain\": [-0.3, 16.3]}, \"title\": null, \"type\": \"quantitative\"}, \"y\": {\"axis\": {\"grid\": false}, \"field\": \"Coverage\", \"scale\": {\"domain\": [0, 170]}, \"title\": \"Coverage\", \"type\": \"quantitative\"}}}, {\"mark\": {\"type\": \"text\", \"dy\": -8, \"fontSize\": 12}, \"encoding\": {\"text\": {\"field\": \"Coverage\", \"format\": \".0f\", \"type\": \"quantitative\"}, \"x\": {\"field\": \"x_position\", \"type\": \"quantitative\"}, \"y\": {\"field\": \"Coverage\", \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-aa5469676eebfdcf76d13f2a061c1686\"}, \"mark\": {\"type\": \"rule\", \"color\": \"gray\", \"strokeWidth\": 1}, \"encoding\": {\"x\": {\"field\": \"x\", \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-96d617e279b940cb811ebf063eb8b596\"}, \"mark\": {\"type\": \"text\", \"fontSize\": 16}, \"encoding\": {\"text\": {\"field\": \"label\", \"type\": \"nominal\"}, \"x\": {\"field\": \"x\", \"type\": \"quantitative\"}, \"y\": {\"field\": \"y\", \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-001d68cc8d2bc376c046ef92b3582b22\"}, \"mark\": {\"type\": \"text\", \"fontSize\": 14}, \"encoding\": {\"text\": {\"field\": \"label\", \"type\": \"nominal\"}, \"x\": {\"field\": \"x\", \"type\": \"quantitative\"}, \"y\": {\"field\": \"y\", \"type\": \"quantitative\"}}}], \"data\": {\"name\": \"data-799be74ece45aad5bdfca780af67b29c\"}, \"$schema\": \"https://vega.github.io/schema/vega-lite/v6.1.0.json\", \"datasets\": {\"data-799be74ece45aad5bdfca780af67b29c\": [{\"SampleID\": \"CU1\", \"Coverage\": 125.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\", \"x_position\": 0}, {\"SampleID\": \"CU2\", \"Coverage\": 138.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\", \"x_position\": 1}, {\"SampleID\": \"CU3\", \"Coverage\": 118.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\", \"x_position\": 2}, {\"SampleID\": \"CA1\", \"Coverage\": 94.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\", \"x_position\": 4}, {\"SampleID\": \"CA2\", \"Coverage\": 111.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\", \"x_position\": 5}, {\"SampleID\": \"CA3\", \"Coverage\": 31.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\", \"x_position\": 6}, {\"SampleID\": \"GU1\", \"Coverage\": 98.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\", \"x_position\": 10}, {\"SampleID\": \"GU2\", \"Coverage\": 70.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\", \"x_position\": 11}, {\"SampleID\": \"GU3\", \"Coverage\": 94.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\", \"x_position\": 12}, {\"SampleID\": \"GA1\", \"Coverage\": 62.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\", \"x_position\": 14}, {\"SampleID\": \"GA2\", \"Coverage\": 84.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\", \"x_position\": 15}, {\"SampleID\": \"GA3\", \"Coverage\": 99.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\", \"x_position\": 16}], \"data-aa5469676eebfdcf76d13f2a061c1686\": [{\"x\": 8}], \"data-96d617e279b940cb811ebf063eb8b596\": [{\"x\": 3, \"y\": 162, \"label\": \"cfDNA\"}, {\"x\": 13, \"y\": 162, \"label\": \"gDNA\"}], \"data-001d68cc8d2bc376c046ef92b3582b22\": [{\"x\": 1, \"y\": -8, \"label\": \"UMBS\"}, {\"x\": 5, \"y\": -8, \"label\": \"SBS\"}, {\"x\": 11, \"y\": -8, \"label\": \"UMBS\"}, {\"x\": 15, \"y\": -8, \"label\": \"SBS\"}]}}, {\"mode\": \"vega-lite\"});\n",
       "</script>"
      ],
      "text/plain": [
       "alt.LayerChart(...)"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "bars = alt.Chart(df2_positioned).mark_bar(width=21).encode(\n",
    "    x=alt.X('x_position:Q', \n",
    "            title=None,\n",
    "            axis=alt.Axis(labels=False, ticks=False, grid=False, domain=False),\n",
    "            scale=alt.Scale(domain=[-0.3, 16.3])),\n",
    "    y=alt.Y('Coverage:Q', \n",
    "            title='Coverage',\n",
    "            scale=alt.Scale(domain=[0, 170]),\n",
    "            axis=alt.Axis(grid=False)),\n",
    "    color=alt.Color('Treatment:N', \n",
    "                    title='Treatment',\n",
    "                    sort=['UMBS', 'SBS'],\n",
    "                    scale=alt.Scale(domain=['UMBS', 'SBS'], \n",
    "                               range=[vega_colors['blue'], vega_colors['orange']]),  # blue, orange\n",
    "                    legend=None)\n",
    ")\n",
    "\n",
    "value_labels = alt.Chart(df2_positioned).mark_text(dy=-8, fontSize=12).encode(\n",
    "    x=alt.X('x_position:Q'),\n",
    "    y=alt.Y('Coverage:Q'),\n",
    "    text=alt.Text('Coverage:Q', format='.0f')\n",
    ")\n",
    "\n",
    "divider = alt.Chart(pl.DataFrame({'x': [8]})).mark_rule(\n",
    "    color='gray',\n",
    "    strokeWidth=1\n",
    ").encode(x=alt.X('x:Q'))\n",
    "\n",
    "top_labels = alt.Chart(pl.DataFrame({\n",
    "    'x': [3, 13],\n",
    "    'y': [162, 162],\n",
    "    'label': ['cfDNA', 'gDNA']\n",
    "})).mark_text(fontSize=16).encode(\n",
    "    x=alt.X('x:Q'),\n",
    "    y=alt.Y('y:Q'),\n",
    "    text='label:N'\n",
    ")\n",
    "\n",
    "treatment_labels = alt.Chart(pl.DataFrame({\n",
    "    'x': [1, 5, 11, 15],\n",
    "    'y': [-8, -8, -8, -8],\n",
    "    'label': ['UMBS', 'SBS', 'UMBS', 'SBS']\n",
    "})).mark_text(fontSize=14).encode(\n",
    "    x=alt.X('x:Q'),\n",
    "    y=alt.Y('y:Q'),\n",
    "    text='label:N'\n",
    ")\n",
    "\n",
    "chart = (bars + value_labels + divider + top_labels + treatment_labels).properties(\n",
    "    width=600,\n",
    "    height=400\n",
    ").configure_view(\n",
    "    stroke='gray',\n",
    "    strokeWidth=2\n",
    ")\n",
    "\n",
    "chart"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/markdown": [
       "üí≠ Claude: You're absolutely right! Looking at your theme, it doesn't specify colors. The colors you're seeing without explicit specification are likely coming from **Vega's default categorical color scheme**, which uses more muted colors similar to matplotlib's defaults.\n",
       "\n",
       "The standard Altair/Vega default categorical colors (what you see when you don't specify anything) are:\n",
       "\n",
       "1. `#4c78a8` - Muted blue\n",
       "2. `#f58518` - Muted orange  \n",
       "3. `#e45756` - Muted red\n",
       "4. `#72b7b2` - Muted teal\n",
       "5. `#54a24b` - Muted green\n",
       "6. `#eeca3b` - Muted yellow\n",
       "7. `#b279a2` - Muted purple\n",
       "8. `#ff9da6` - Light pink\n",
       "9. `#9d755d` - Muted brown\n",
       "10. `#bab0ac` - Gray\n",
       "\n",
       "These are indeed closer to matplotlib's color scheme and more muted than the bright `category10` colors.\n",
       "\n",
       "To use these colors explicitly, you can either:\n",
       "\n",
       "**Option 1: Don't specify a scale at all (let theme use defaults)**\n",
       "```python\n",
       "color=alt.Color('Treatment:N', \n",
       "                sort=['UMBS', 'SBS'],\n",
       "                legend=None)\n",
       "```\n",
       "\n",
       "**Option 2: Explicitly use the Vega default scheme**\n",
       "```python\n",
       "color=alt.Color('Treatment:N', \n",
       "                sort=['UMBS', 'SBS'],\n",
       "                scale=alt.Scale(scheme='tableau10'),\n",
       "                legend=None)\n",
       "```\n",
       "\n",
       "Would you like me to generate code using these muted colors instead?"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "%%cc These colors look brighter than when I dont specify a color. They are not the same. \n",
    "Look at my theme. It doesn't appear to stipulate colors. \n",
    "The original colors loook like those from matplotlib"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "‚úÖ Continuing Claude session with execution results...\n",
      "\n",
      "============================================================\n",
      "ü§ñ Claude wants to execute code\n",
      "------------------------------------------------------------\n",
      "üìã To approve: Run the cell below\n",
      "‚û°Ô∏è To continue Claude agentically afterward: Run %cc\n",
      "============================================================\n",
      "\n"
     ]
    },
    {
     "data": {
      "text/markdown": [
       "üí≠ Claude: I see you've provided the color codes. Let me create a `vega_colors` dictionary with those exact colors:"
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "‚è∫ CreateNotebookCell\n"
     ]
    },
    {
     "data": {
      "text/markdown": [
       "üí≠ Claude: This creates the `vega_colors` dictionary with the muted Vega color palette you provided, with simple color names as keys mapped to their hex codes."
      ],
      "text/plain": [
       "<IPython.core.display.Markdown object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "%cc print out a dict called vega_colors. Shown below\n",
    "#4c78a8 - Muted blue\n",
    "#f58518 - Muted orange\n",
    "#e45756 - Muted red\n",
    "#72b7b2 - Muted teal\n",
    "#54a24b - Muted green\n",
    "#eeca3b - Muted yellow\n",
    "#b279a2 - Muted purple\n",
    "#ff9da6 - Light pink\n",
    "#9d755d - Muted brown\n",
    "#bab0ac - Gray"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "\n",
       "<style>\n",
       "  #altair-viz-ced5e0d7deb045068471846140afdbe3.vega-embed {\n",
       "    width: 100%;\n",
       "    display: flex;\n",
       "  }\n",
       "\n",
       "  #altair-viz-ced5e0d7deb045068471846140afdbe3.vega-embed details,\n",
       "  #altair-viz-ced5e0d7deb045068471846140afdbe3.vega-embed details summary {\n",
       "    position: relative;\n",
       "  }\n",
       "</style>\n",
       "<div id=\"altair-viz-ced5e0d7deb045068471846140afdbe3\"></div>\n",
       "<script type=\"text/javascript\">\n",
       "  var VEGA_DEBUG = (typeof VEGA_DEBUG == \"undefined\") ? {} : VEGA_DEBUG;\n",
       "  (function(spec, embedOpt){\n",
       "    let outputDiv = document.currentScript.previousElementSibling;\n",
       "    if (outputDiv.id !== \"altair-viz-ced5e0d7deb045068471846140afdbe3\") {\n",
       "      outputDiv = document.getElementById(\"altair-viz-ced5e0d7deb045068471846140afdbe3\");\n",
       "    }\n",
       "\n",
       "    const paths = {\n",
       "      \"vega\": \"https://cdn.jsdelivr.net/npm/vega@6?noext\",\n",
       "      \"vega-lib\": \"https://cdn.jsdelivr.net/npm/vega-lib?noext\",\n",
       "      \"vega-lite\": \"https://cdn.jsdelivr.net/npm/vega-lite@6.1.0?noext\",\n",
       "      \"vega-embed\": \"https://cdn.jsdelivr.net/npm/vega-embed@7?noext\",\n",
       "    };\n",
       "\n",
       "    function maybeLoadScript(lib, version) {\n",
       "      var key = `${lib.replace(\"-\", \"\")}_version`;\n",
       "      return (VEGA_DEBUG[key] == version) ?\n",
       "        Promise.resolve(paths[lib]) :\n",
       "        new Promise(function(resolve, reject) {\n",
       "          var s = document.createElement('script');\n",
       "          document.getElementsByTagName(\"head\")[0].appendChild(s);\n",
       "          s.async = true;\n",
       "          s.onload = () => {\n",
       "            VEGA_DEBUG[key] = version;\n",
       "            return resolve(paths[lib]);\n",
       "          };\n",
       "          s.onerror = () => reject(`Error loading script: ${paths[lib]}`);\n",
       "          s.src = paths[lib];\n",
       "        });\n",
       "    }\n",
       "\n",
       "    function showError(err) {\n",
       "      outputDiv.innerHTML = `<div class=\"error\" style=\"color:red;\">${err}</div>`;\n",
       "      throw err;\n",
       "    }\n",
       "\n",
       "    function displayChart(vegaEmbed) {\n",
       "      vegaEmbed(outputDiv, spec, embedOpt)\n",
       "        .catch(err => showError(`Javascript Error: ${err.message}<br>This usually means there's a typo in your chart specification. See the javascript console for the full traceback.`));\n",
       "    }\n",
       "\n",
       "    if(typeof define === \"function\" && define.amd) {\n",
       "      requirejs.config({paths});\n",
       "      let deps = [\"vega-embed\"];\n",
       "      require(deps, displayChart, err => showError(`Error loading script: ${err.message}`));\n",
       "    } else {\n",
       "      maybeLoadScript(\"vega\", \"6\")\n",
       "        .then(() => maybeLoadScript(\"vega-lite\", \"6.1.0\"))\n",
       "        .then(() => maybeLoadScript(\"vega-embed\", \"7\"))\n",
       "        .catch(showError)\n",
       "        .then(() => displayChart(vegaEmbed));\n",
       "    }\n",
       "  })({\"width\": 600, \"height\": 400, \"config\": {\"axisX\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"titleFontWeight\": 100, \"labelAngle\": 0, \"labelFont\": \"\", \"titleFont\": \"\"}, \"axisY\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"titleFontWeight\": 100, \"labelAngle\": 0, \"labelFont\": \"\", \"titleFont\": \"\"}, \"title\": {\"fontSize\": 25, \"fontWeight\": 200, \"offset\": 20, \"font\": \"\"}, \"legend\": {\"labelFontSize\": 14, \"titleFontSize\": 18, \"symbolSize\": 600, \"titleFontWeight\": 200, \"labelFont\": \"\", \"titleFont\": \"\"}, \"text\": {\"font\": \"\", \"fontWeight\": 100}, \"view\": {\"stroke\": \"gray\", \"strokeWidth\": 2}}, \"layer\": [{\"mark\": {\"type\": \"bar\", \"width\": 21}, \"encoding\": {\"color\": {\"field\": \"Treatment\", \"legend\": null, \"sort\": [\"UMBS\", \"SBS\"], \"title\": \"Treatment\", \"type\": \"nominal\"}, \"x\": {\"axis\": {\"domain\": false, \"grid\": false, \"labels\": false, \"ticks\": false}, \"field\": \"x_position\", \"scale\": {\"domain\": [-0.3, 16.3]}, \"title\": null, \"type\": \"quantitative\"}, \"y\": {\"axis\": {\"grid\": false}, \"field\": \"Coverage\", \"scale\": {\"domain\": [0, 170]}, \"title\": \"Coverage\", \"type\": \"quantitative\"}}}, {\"mark\": {\"type\": \"text\", \"dy\": -8, \"fontSize\": 12}, \"encoding\": {\"text\": {\"field\": \"Coverage\", \"format\": \".0f\", \"type\": \"quantitative\"}, \"x\": {\"field\": \"x_position\", \"type\": \"quantitative\"}, \"y\": {\"field\": \"Coverage\", \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-aa5469676eebfdcf76d13f2a061c1686\"}, \"mark\": {\"type\": \"rule\", \"color\": \"gray\", \"strokeWidth\": 1}, \"encoding\": {\"x\": {\"field\": \"x\", \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-96d617e279b940cb811ebf063eb8b596\"}, \"mark\": {\"type\": \"text\", \"fontSize\": 16}, \"encoding\": {\"text\": {\"field\": \"label\", \"type\": \"nominal\"}, \"x\": {\"field\": \"x\", \"type\": \"quantitative\"}, \"y\": {\"field\": \"y\", \"type\": \"quantitative\"}}}, {\"data\": {\"name\": \"data-001d68cc8d2bc376c046ef92b3582b22\"}, \"mark\": {\"type\": \"text\", \"fontSize\": 14}, \"encoding\": {\"text\": {\"field\": \"label\", \"type\": \"nominal\"}, \"x\": {\"field\": \"x\", \"type\": \"quantitative\"}, \"y\": {\"field\": \"y\", \"type\": \"quantitative\"}}}], \"data\": {\"name\": \"data-799be74ece45aad5bdfca780af67b29c\"}, \"$schema\": \"https://vega.github.io/schema/vega-lite/v6.1.0.json\", \"datasets\": {\"data-799be74ece45aad5bdfca780af67b29c\": [{\"SampleID\": \"CU1\", \"Coverage\": 125.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\", \"x_position\": 0}, {\"SampleID\": \"CU2\", \"Coverage\": 138.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\", \"x_position\": 1}, {\"SampleID\": \"CU3\", \"Coverage\": 118.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"UMBS\", \"x_position\": 2}, {\"SampleID\": \"CA1\", \"Coverage\": 94.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\", \"x_position\": 4}, {\"SampleID\": \"CA2\", \"Coverage\": 111.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\", \"x_position\": 5}, {\"SampleID\": \"CA3\", \"Coverage\": 31.0, \"Dna_type\": \"cfDNA\", \"Treatment\": \"SBS\", \"x_position\": 6}, {\"SampleID\": \"GU1\", \"Coverage\": 98.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\", \"x_position\": 10}, {\"SampleID\": \"GU2\", \"Coverage\": 70.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\", \"x_position\": 11}, {\"SampleID\": \"GU3\", \"Coverage\": 94.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"UMBS\", \"x_position\": 12}, {\"SampleID\": \"GA1\", \"Coverage\": 62.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\", \"x_position\": 14}, {\"SampleID\": \"GA2\", \"Coverage\": 84.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\", \"x_position\": 15}, {\"SampleID\": \"GA3\", \"Coverage\": 99.0, \"Dna_type\": \"gDNA\", \"Treatment\": \"SBS\", \"x_position\": 16}], \"data-aa5469676eebfdcf76d13f2a061c1686\": [{\"x\": 8}], \"data-96d617e279b940cb811ebf063eb8b596\": [{\"x\": 3, \"y\": 162, \"label\": \"cfDNA\"}, {\"x\": 13, \"y\": 162, \"label\": \"gDNA\"}], \"data-001d68cc8d2bc376c046ef92b3582b22\": [{\"x\": 1, \"y\": -8, \"label\": \"UMBS\"}, {\"x\": 5, \"y\": -8, \"label\": \"SBS\"}, {\"x\": 11, \"y\": -8, \"label\": \"UMBS\"}, {\"x\": 15, \"y\": -8, \"label\": \"SBS\"}]}}, {\"mode\": \"vega-lite\"});\n",
       "</script>"
      ],
      "text/plain": [
       "alt.LayerChart(...)"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "save_chart_alt(chart, title=\"Avida_Median_Base_Coverage_DepthAvida_Median_Base_Coverage_Depth\", fig_path=\".\", save_as=None, file_format='pdf', \n",
    "                   hide=False, scale_factor=2.0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.11"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
